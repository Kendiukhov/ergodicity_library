<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ergodicity.agents package &#8212; Ergodicity Library 0.3.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <script src="../../_static/documentation_options.js?v=e259d695"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ergodicity-agents-package">
<h1>ergodicity.agents package<a class="headerlink" href="#ergodicity-agents-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ergodicity.agents.agent_pool">
<span id="ergodicity-agents-agent-pool-module"></span><h2>ergodicity.agents.agent_pool module<a class="headerlink" href="#module-ergodicity.agents.agent_pool" title="Link to this heading">¶</a></h2>
<p>agent_pool Submodule Overview</p>
<p>The <strong>`agent_pool`</strong> submodule focuses on simulating and analyzing the wealth dynamics of a pool of agents interacting with stochastic processes. Agents share wealth dynamically based on a specified sharing rate, and the module provides tools to study how wealth distributions and inequality evolve over time.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Agent Pool Simulation</strong>:</p>
<ul class="simple">
<li><p>Simulate the evolution of wealth for a group of agents interacting with a stochastic process (e.g., Geometric Brownian Motion, Lévy processes).</p></li>
<li><p>Each agent starts with a specified initial wealth, and the evolution of their wealth depends on both the process and the sharing rules.</p></li>
</ul>
</li>
<li><p><strong>Dynamic Sharing Rate</strong>:</p>
<ul class="simple">
<li><p>Agents can share wealth dynamically based on their relative wealth or a fixed sharing rate.</p></li>
<li><p>The simulation can be run with either static or dynamic sharing rates.</p></li>
</ul>
</li>
<li><p><strong>Wealth History</strong>:</p>
<ul class="simple">
<li><p>Track the wealth of each agent over time. The full wealth history is recorded and can be saved for further analysis.</p></li>
</ul>
</li>
<li><p><strong>Wealth Inequality Measures</strong>:</p>
<ul class="simple">
<li><p>The module provides several key metrics to measure wealth inequality, including:</p>
<ul>
<li><p><strong>Mean Logarithmic Deviation (MLD)</strong>: A measure of wealth inequality based on the deviation from the mean.</p></li>
<li><p><strong>Gini Coefficient</strong>: A common measure of inequality based on the distribution of wealth.</p></li>
<li><p><strong>Coefficient of Variation (CV)</strong>: The ratio of standard deviation to the mean wealth.</p></li>
<li><p><strong>Palma Ratio</strong>: The ratio of wealth held by the richest 10% compared to the poorest 40%.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Wealth Distribution Analysis</strong>:</p>
<ul class="simple">
<li><p>Save and visualize the final wealth distribution in both normal and log-log scales.</p></li>
<li><p>Fit a power law distribution to the wealth data to study the tail behavior.</p></li>
</ul>
</li>
<li><p><strong>3D Wealth Visualization</strong>:</p>
<ul class="simple">
<li><p>Create static and interactive 3D plots of total wealth as a function of the number of agents and the sharing rate.</p></li>
<li><p>Use Matplotlib for static 3D visualization and Plotly for interactive 3D graphs, which can be saved as HTML.</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p>### Basic Simulation:</p>
<p>from ergodicity.process.multiplicative import GeometricBrownianMotion</p>
<p>from ergodicity.agent_pool import AgentPool</p>
<p># Initialize process (e.g., GeometricBrownianMotion)</p>
<p>process = GeometricBrownianMotion(drift=0.02, volatility=0.15)</p>
<p># Initialize agent pool with 100 agents, starting wealth of 100, sharing rate of 0.1, and time horizon of 10</p>
<p>pool = AgentPool(process, n=100, w=100, s=0.1, time=10)</p>
<p># Simulate the wealth dynamics</p>
<p>pool.simulate(dynamic_s=False)</p>
<p># Plot wealth evolution</p>
<p>pool.plot()</p>
<p># Save and plot final wealth distribution</p>
<p>pool.save_and_plot_wealth_distribution(‘final_wealth’)</p>
<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agent_pool.</span></span><span class="sig-name descname"><span class="pre">AgentPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>AgentPool represents a collection of agents participating in a wealth dynamics simulation.
This class simulates the evolution of wealth for a group of agents over time, incorporating
a stochastic process for wealth changes and an optional wealth-sharing mechanism. It provides
methods for simulation, data analysis, and visualization of wealth dynamics and inequality measures.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.process">
<span class="sig-name descname"><span class="pre">process</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.process" title="Link to this definition">¶</a></dt>
<dd><p>The stochastic process used for simulating wealth changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.n">
<span class="sig-name descname"><span class="pre">n</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.n" title="Link to this definition">¶</a></dt>
<dd><p>Number of agents in the pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.initial_wealth">
<span class="sig-name descname"><span class="pre">initial_wealth</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.initial_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Starting wealth for each agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.base_s">
<span class="sig-name descname"><span class="pre">base_s</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.base_s" title="Link to this definition">¶</a></dt>
<dd><p>Base sharing rate for wealth redistribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.time">
<span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.time" title="Link to this definition">¶</a></dt>
<dd><p>Total simulation time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.timestep">
<span class="sig-name descname"><span class="pre">timestep</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.timestep" title="Link to this definition">¶</a></dt>
<dd><p>Time step for wealth updates and sharing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.simulation_timestep">
<span class="sig-name descname"><span class="pre">simulation_timestep</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.simulation_timestep" title="Link to this definition">¶</a></dt>
<dd><p>Time step for the underlying stochastic process simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.wealth">
<span class="sig-name descname"><span class="pre">wealth</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.wealth" title="Link to this definition">¶</a></dt>
<dd><p>Current wealth of each agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.history">
<span class="sig-name descname"><span class="pre">history</span></span><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.history" title="Link to this definition">¶</a></dt>
<dd><p>Historical record of wealth for all agents at each time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<p>This class is useful for studying wealth inequality, the effects of different sharing mechanisms,
and the impact of various stochastic processes on wealth distribution in a population of agents.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.coefficient_of_variation">
<span class="sig-name descname"><span class="pre">coefficient_of_variation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.coefficient_of_variation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.coefficient_of_variation" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Coefficient of Variation for each time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of CV values for each time step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.gini_coefficient">
<span class="sig-name descname"><span class="pre">gini_coefficient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.gini_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.gini_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Gini coefficient for each time step.
The Gini coefficient is a measure of statistical dispersion intended to represent the income or wealth distribution of a nation’s residents.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of Gini coefficient values for each time step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.mean_logarithmic_deviation">
<span class="sig-name descname"><span class="pre">mean_logarithmic_deviation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.mean_logarithmic_deviation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.mean_logarithmic_deviation" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Mean Logarithmic Deviation (MLD) for each time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of MLD values for each time step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.palma_ratio">
<span class="sig-name descname"><span class="pre">palma_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.palma_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.palma_ratio" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Palma ratio for each time step.
The Palma ratio is the ratio of the richest 10% of the population’s share of gross national income divided by the poorest 40%’s share.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of Palma ratio values for each time step</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.plot" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the wealth dynamics of all agents over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.plot_inequality_measures">
<span class="sig-name descname"><span class="pre">plot_inequality_measures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.plot_inequality_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.plot_inequality_measures" title="Link to this definition">¶</a></dt>
<dd><p>Plot all implemented inequality measures over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.save_and_plot_wealth_distribution">
<span class="sig-name descname"><span class="pre">save_and_plot_wealth_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.save_and_plot_wealth_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.save_and_plot_wealth_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Save and plot the final wealth distribution in normal and log-log scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename_prefix</strong> (<em>str</em>) – Prefix for saving the plot files</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.save_data" title="Link to this definition">¶</a></dt>
<dd><p>Save the wealth history data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Name of the file to save the data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.AgentPool.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#AgentPool.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.AgentPool.simulate" title="Link to this definition">¶</a></dt>
<dd><p>Run the wealth dynamics simulation for the specified time horizon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dynamic_s</strong> (<em>bool</em>) – If True, agents share wealth dynamically based on their relative wealth</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of wealth history for all agents at each time step</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agent_pool.plot_wealth_3d">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agent_pool.</span></span><span class="sig-name descname"><span class="pre">plot_wealth_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_html</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agent_pool.html#plot_wealth_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agent_pool.plot_wealth_3d" title="Link to this definition">¶</a></dt>
<dd><p>Plot a 3D graph of average wealth as a function of sharing rate s and number of agents n.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process</strong> (<em>StochasticProcess</em>) – The stochastic process to use (e.g., GeometricBrownianMotion instance)</p></li>
<li><p><strong>w</strong> (<em>float</em>) – Initial wealth for each agent</p></li>
<li><p><strong>time</strong> (<em>float</em>) – Total simulation time</p></li>
<li><p><strong>simulation_timestep</strong> (<em>float</em>) – Timestep for the simulation</p></li>
<li><p><strong>timestep</strong> (<em>float</em>) – Timestep for the sharing and update of AgentPool</p></li>
<li><p><strong>s_range</strong> (<em>numpy.ndarray</em>) – Range of sharing rates to plot (e.g., np.linspace(0, 0.5, 20))</p></li>
<li><p><strong>n_range</strong> (<em>range</em>) – Range of number of agents to plot (e.g., range(5, 105, 5))</p></li>
<li><p><strong>save_html</strong> (<em>bool</em>) – If True, save an interactive 3D plot as an HTML file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ergodicity.agents.agents">
<span id="ergodicity-agents-agents-module"></span><h2>ergodicity.agents.agents module<a class="headerlink" href="#module-ergodicity.agents.agents" title="Link to this heading">¶</a></h2>
<p>agents Submodule Overview</p>
<p>The <strong>`agents`</strong> module focuses on creating and managing economic agents that optimize their utility functions over time in a stochastic environment. It provides various algorithms and tools for simulating agent behavior, evolving utility functions, and running multi-agent evolutionary processes. These agents interact with multiple stochastic processes, making decisions based on expected utility and wealth maximization.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Utility Functions</strong>:</p>
<ul class="simple">
<li><p>Each agent uses a general utility function parameterized by alpha, beta, gamma, delta, and epsilon.</p></li>
<li><p>Utility functions are used to calculate the expected utility from various stochastic processes.</p></li>
</ul>
</li>
<li><p><strong>Expected Utility</strong>:</p>
<ul class="simple">
<li><p>The module allows agents to calculate expected utility either numerically (via process simulations) or symbolically (via integral approximations).</p></li>
</ul>
</li>
<li><p><strong>Evolutionary Algorithms</strong>:</p>
<ul class="simple">
<li><p>Agents evolve over time using evolutionary algorithms that simulate wealth accumulation and utility optimization.</p></li>
<li><p>Agents with higher utility accumulate more wealth and influence the population’s evolution.</p></li>
<li><p>Includes features like mutation, agent reproduction, and selection of top-performing agents.</p></li>
</ul>
</li>
<li><p><strong>Processes</strong>:</p>
<ul class="simple">
<li><p>Agents interact with multiple stochastic processes, such as Geometric Brownian Motion or Geometric Lévy processes, to maximize their wealth.</p></li>
<li><p>Agents select and invest in the best process based on expected utility.</p></li>
</ul>
</li>
<li><p><strong>Multi-Agent Simulations</strong>:</p>
<ul class="simple">
<li><p>The module provides tools to simulate the behavior of a population of agents over multiple time steps.</p></li>
<li><p>Agents are removed or duplicated based on their performance, and new agents are created through mutation.</p></li>
</ul>
</li>
<li><p><strong>Visualization</strong>:</p>
<ul class="simple">
<li><p>Includes tools for visualizing agent evolution, utility function evolution, and other trends over time.</p></li>
<li><p>Provides methods to generate animations and CSV logs for post-simulation analysis.</p></li>
</ul>
</li>
<li><p><strong>Support for Numerical and Symbolic Computation</strong>:</p>
<ul class="simple">
<li><p>Both symbolic and numerical approaches are supported for computing expected utility, offering flexibility in different simulation scenarios.</p></li>
</ul>
</li>
<li><p><strong>Evolution with Multiple Processes</strong>:</p>
<ul class="simple">
<li><p>Agents can select from multiple stochastic processes, optimizing their utility functions in a diverse environment.</p></li>
<li><p>The module supports the creation of multiple stochastic processes and allows agents to interact with them over time.</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p>### Basic Usage of Evolutionary Algorithm:</p>
<p>from ergodicity.process.multiplicative import GeometricBrownianMotion</p>
<p>from ergodicity.agents import Agent_utility</p>
<p># Define parameters for agents</p>
<p>param_means = np.array([1.0, 1.0, 0.5, 1.0])</p>
<p>param_stds = np.array([0.1, 0.1, 0.05, 0.1])</p>
<p>mutation_rate = 0.01</p>
<p># Define a set of stochastic processes</p>
<dl class="simple">
<dt>processes = [</dt><dd><p>GeometricBrownianMotion(drift=0.02, volatility=0.15),
GeometricBrownianMotion(drift=0.03, volatility=0.18)</p>
</dd>
</dl>
<p>]</p>
<p># Run the evolutionary algorithm</p>
<dl class="simple">
<dt>final_agents, history = Agent_utility.evolutionary_algorithm(</dt><dd><p>n_agents=100,
n_steps=1000,
save_interval=50,
processes=processes,
param_means=param_means,
param_stds=param_stds,
mutation_rate=mutation_rate,
stochastic_process_class=GeometricBrownianMotion,
keep_top_n=50,
removal_interval=10,
process_selection_share=0.5</p>
</dd>
</dl>
<p>)</p>
<p># Visualize agent evolution</p>
<p>Agent_utility.visualize_agent_evolution(history)</p>
<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">Agent_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wealth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_accumulated_wealth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents an agent with utility-based decision making in stochastic processes.</p>
<p>This class implements an agent that can evaluate and interact with various stochastic processes
based on a parameterized utility function. It supports both symbolic and numerical methods for
calculating expected utilities, and includes evolutionary algorithms for optimizing agent parameters.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.params" title="Link to this definition">¶</a></dt>
<dd><p>Parameters of the agent’s utility function [alpha, beta, gamma, delta, epsilon].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.wealth">
<span class="sig-name descname"><span class="pre">wealth</span></span><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.wealth" title="Link to this definition">¶</a></dt>
<dd><p>Current wealth of the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.total_accumulated_wealth">
<span class="sig-name descname"><span class="pre">total_accumulated_wealth</span></span><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.total_accumulated_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Total accumulated wealth of the agent over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p>The class provides comprehensive tools for modeling agent behavior in complex stochastic environments,
including utility calculation, parameter optimization, and visualization of results. It is particularly
useful for studying optimal strategies in financial markets, decision making under uncertainty, and
evolutionary dynamics in economic systems.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.compare_numerical_and_symbolic_expected_utility">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compare_numerical_and_symbolic_expected_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_process_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.compare_numerical_and_symbolic_expected_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.compare_numerical_and_symbolic_expected_utility" title="Link to this definition">¶</a></dt>
<dd><p>Compare the numerical and symbolic expected utility calculations for a given process and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary containing the symbolic function and process parameters</p></li>
<li><p><strong>params</strong> (<em>np.ndarray</em>) – Parameters of the utility function [alpha, beta, gamma, delta, epsilon]</p></li>
<li><p><strong>stochastic_process_class</strong> (<em>Type</em>) – The class of the stochastic process</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Time horizon for the process. If None, compares functions instead of specific values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (prints the comparison results)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.evolutionary_algorithm">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evolutionary_algorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_agents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_stds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_process_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removal_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_selection_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_utilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.evolutionary_algorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.evolutionary_algorithm" title="Link to this definition">¶</a></dt>
<dd><p>Run an evolutionary algorithm to optimize agent parameters based on expected utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_agents</strong> (<em>int</em>) – Number of agents in the population</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps to run the algorithm</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – Interval for saving intermediate results</p></li>
<li><p><strong>processes</strong> (<em>List</em><em>[</em><em>Union</em><em>[</em><em>dict</em><em>, </em><em>object</em><em>]</em><em>]</em>) – List of stochastic processes for agents to interact with</p></li>
<li><p><strong>param_means</strong> (<em>np.ndarray</em>) – Means of the parameter distributions</p></li>
<li><p><strong>param_stds</strong> (<em>np.ndarray</em>) – Standard deviations of the parameter distributions</p></li>
<li><p><strong>mutation_rate</strong> (<em>float</em>) – Rate of mutation for agent parameters</p></li>
<li><p><strong>stochastic_process_class</strong> (<em>Type</em>) – Class of the stochastic process (if using dict-based processes)</p></li>
<li><p><strong>keep_top_n</strong> (<em>int</em>) – Number of top agents to keep after each removal interval</p></li>
<li><p><strong>removal_interval</strong> (<em>int</em>) – Interval for removing agents based on performance (in time units)</p></li>
<li><p><strong>process_selection_share</strong> (<em>float</em>) – Share of processes to select for each agent (0 to 1)</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory to save output files</p></li>
<li><p><strong>process_time</strong> (<em>float</em>) – Time horizon for the stochastic processes</p></li>
<li><p><strong>numeric_utilities</strong> (<em>bool</em>) – Use numerical utility calculation if True, else use symbolic</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.html#ergodicity.custom_warnings.InDevelopmentWarning" title="ergodicity.custom_warnings.InDevelopmentWarning"><strong>InDevelopmentWarning</strong></a> – If numeric_utilities is False (feature in development)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of final agents and history of the evolutionary process</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.agents.Agent_utility" title="ergodicity.agents.agents.Agent_utility">Agent_utility</a>], List[Dict[str, Any]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.evolutionary_algorithm_with_exchange">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evolutionary_algorithm_with_exchange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_agents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_stds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_process_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_selection_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_utilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.evolutionary_algorithm_with_exchange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.evolutionary_algorithm_with_exchange" title="Link to this definition">¶</a></dt>
<dd><p>Run an evolutionary algorithm to optimize agent parameters based on expected utility with the exchange of parameters (evolution-like mixing of genetic information).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_agents</strong> (<em>int</em>) – Number of agents in the population</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps to run the algorithm</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – Interval for saving intermediate results</p></li>
<li><p><strong>processes</strong> (<em>List</em><em>[</em><em>Union</em><em>[</em><em>dict</em><em>, </em><em>object</em><em>]</em><em>]</em>) – List of stochastic processes for agents to interact with</p></li>
<li><p><strong>param_means</strong> (<em>np.ndarray</em>) – Means of the parameter distributions</p></li>
<li><p><strong>param_stds</strong> (<em>np.ndarray</em>) – Standard deviations of the parameter distributions</p></li>
<li><p><strong>noise_std</strong> (<em>float</em>) – Standard deviation of the noise added to averaged parameters</p></li>
<li><p><strong>stochastic_process_class</strong> (<em>Type</em>) – The class of the stochastic process (if using dict-based processes)</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – Number of top agents to keep after each selection interval</p></li>
<li><p><strong>process_selection_share</strong> (<em>float</em>) – Share of processes to select for each agent (0 to 1)</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory to save output files</p></li>
<li><p><strong>s</strong> (<em>int</em>) – Interval for selection, averaging, and multiplication</p></li>
<li><p><strong>process_time</strong> (<em>float</em>) – Time horizon for the stochastic processes</p></li>
<li><p><strong>numeric_utilities</strong> (<em>bool</em>) – Use numerical utility calculation if True, else use symbolic</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.html#ergodicity.custom_warnings.InDevelopmentWarning" title="ergodicity.custom_warnings.InDevelopmentWarning"><strong>InDevelopmentWarning</strong></a> – If numeric_utilities is False (feature in development)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of final agents and history of the evolutionary process</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.agents.Agent_utility" title="ergodicity.agents.agents.Agent_utility">Agent_utility</a>], List[Dict[str, Any]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.evolutionary_algorithm_with_multiple_processes">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evolutionary_algorithm_with_multiple_processes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_agents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_stds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removal_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_selection_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_utilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.evolutionary_algorithm_with_multiple_processes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.evolutionary_algorithm_with_multiple_processes" title="Link to this definition">¶</a></dt>
<dd><p>Run an evolutionary algorithm to optimize agent parameters based on expected utility with multiple process types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_agents</strong> (<em>int</em>) – Number of agents in the population</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps to run the algorithm</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – Interval for saving intermediate results</p></li>
<li><p><strong>processes</strong> (<em>List</em><em>[</em><em>Union</em><em>[</em><em>dict</em><em>, </em><em>object</em><em>]</em><em>]</em>) – List of stochastic processes for agents to interact with</p></li>
<li><p><strong>param_means</strong> (<em>np.ndarray</em>) – Means of the parameter distributions</p></li>
<li><p><strong>param_stds</strong> (<em>np.ndarray</em>) – Standard deviations of the parameter distributions</p></li>
<li><p><strong>mutation_rate</strong> (<em>float</em>) – Rate of mutation for agent parameters</p></li>
<li><p><strong>keep_top_n</strong> (<em>int</em>) – Number of top agents to keep after each removal interval</p></li>
<li><p><strong>removal_interval</strong> (<em>int</em>) – Interval for removing agents based on performance (in time units)</p></li>
<li><p><strong>process_selection_share</strong> (<em>float</em>) – Share of processes to select for each agent (0 to 1)</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory to save output files</p></li>
<li><p><strong>process_time</strong> (<em>float</em>) – Time horizon for the stochastic processes</p></li>
<li><p><strong>numeric_utilities</strong> (<em>bool</em>) – Use numerical utility calculation if True, else use symbolic</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.html#ergodicity.custom_warnings.InDevelopmentWarning" title="ergodicity.custom_warnings.InDevelopmentWarning"><strong>InDevelopmentWarning</strong></a> – If numeric_utilities is False (feature in development)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of final agents and history of the evolutionary process</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.agents.Agent_utility" title="ergodicity.agents.agents.Agent_utility">Agent_utility</a>], List[Dict[str, Any]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.expected_utility">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expected_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.expected_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.expected_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the expected utility of a process using robust adaptive numerical integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary containing the symbolic function and process parameters</p></li>
<li><p><strong>params</strong> (<em>np.ndarray</em>) – Parameters of the utility function [alpha, beta, gamma, delta, epsilon]</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Time horizon for the process. If None, returns a function of t.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either a function that computes expected utility for any t, or the numerical value for a specific t</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[Callable[[float], float], float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.general_utility_function">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">general_utility_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.general_utility_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.general_utility_function" title="Link to this definition">¶</a></dt>
<dd><p>Symbolic representation of the general utility function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>sp.Symbol</em>) – The input value</p></li>
<li><p><strong>epsilon</strong> (<em>alpha</em><em>, </em><em>beta</em><em>, </em><em>gamma</em><em>, </em><em>delta</em><em>,</em>) – Utility function parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The utility function expression</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sp.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.general_utility_function_np">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">general_utility_function_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.general_utility_function_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.general_utility_function_np" title="Link to this definition">¶</a></dt>
<dd><p>Numpy version of the general utility function with overflow protection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – The input value(s)</p></li>
<li><p><strong>epsilon</strong> (<em>alpha</em><em>, </em><em>beta</em><em>, </em><em>gamma</em><em>, </em><em>delta</em><em>,</em>) – Utility function parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The utility function value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.initialize_agents">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_agents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_stds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.agents.Agent_utility" title="ergodicity.agents.agents.Agent_utility"><span class="pre">Agent_utility</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.initialize_agents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.initialize_agents" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a population of agents with random parameters drawn from normal distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of agents to create</p></li>
<li><p><strong>param_means</strong> (<em>np.ndarray</em>) – Means of the parameter distributions</p></li>
<li><p><strong>param_stds</strong> (<em>np.ndarray</em>) – Standard deviations of the parameter distributions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of initialized agents</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.mutate_params">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mutate_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.mutate_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.mutate_params" title="Link to this definition">¶</a></dt>
<dd><p>Mutate agent parameters for evolutionary algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>np.ndarray</em>) – Current parameters of the agent</p></li>
<li><p><strong>mutation_rate</strong> (<em>float</em>) – Rate of mutation for the parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mutated parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.numerical_expected_utility">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numerical_expected_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_process_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.numerical_expected_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.numerical_expected_utility" title="Link to this definition">¶</a></dt>
<dd><p>Generate multiple instances of the process and take their average utility to approximate the expected utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>object</em><em>]</em>) – Either a dictionary containing process parameters or an instance of a stochastic process</p></li>
<li><p><strong>params</strong> (<em>np.ndarray</em>) – Parameters of the utility function [alpha, beta, gamma, delta, epsilon]</p></li>
<li><p><strong>stochastic_process_class</strong> (<em>Type</em>) – The class of the stochastic process</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Time horizon for the process. If None, returns a function of t.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either a function that computes expected utility for any t, or the numerical value for a specific t</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[Callable[[float], float], float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">total_accumulated_wealth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.agents.Agent_utility.visualize_utility_function_evolution">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">visualize_utility_function_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_csv_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#Agent_utility.visualize_utility_function_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.Agent_utility.visualize_utility_function_evolution" title="Link to this definition">¶</a></dt>
<dd><p>Create an animation of the evolution of the best agent’s utility function over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – List of dictionaries containing step, best_params, and other data</p></li>
<li><p><strong>output_video_path</strong> (<em>str</em>) – Path to save the output video</p></li>
<li><p><strong>output_csv_path</strong> (<em>str</em>) – Path to save the output CSV file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">wealth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agents.analyze_utility_function_trends">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">analyze_utility_function_trends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_agents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#analyze_utility_function_trends"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.analyze_utility_function_trends" title="Link to this definition">¶</a></dt>
<dd><p>Analyze and visualize trends in the utility functions’ evolutionary dynamics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of dictionaries containing historical data</p></li>
<li><p><strong>num_agents</strong> (<em>int</em>) – Maximum number of top agents to analyze</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (displays plots)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agents.general_utility_function">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">general_utility_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#general_utility_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.general_utility_function" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the utility for a given x and set of parameters.
Works with both SymPy symbols and numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>, </em><em>sp.Expr</em><em>, </em><em>sp.Symbol</em><em>]</em>) – Input value or array</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Utility function parameter</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Utility function parameter</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Utility function parameter</p></li>
<li><p><strong>delta</strong> (<em>float</em>) – Utility function parameter</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Utility function parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated utility expression or array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agents.generate_processes">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">generate_processes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_processes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#generate_processes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.generate_processes" title="Link to this definition">¶</a></dt>
<dd><p>Generate a list of stochastic processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_processes</strong> (<em>int</em>) – Number of processes to generate</p></li>
<li><p><strong>process_types</strong> (<em>list</em>) – List of process classes or functions to use</p></li>
<li><p><strong>param_ranges</strong> (<em>dict</em>) – Dictionary of parameter ranges for each process type</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of generated processes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agents.process_to_dict">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">process_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#process_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.process_to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Converts a process object with a closed_formula method to a dictionary format
compatible with Agent_utility.compare_numerical_and_symbolic_expected_utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>process</strong> (<em>Any</em>) – An object with a closed_formula method</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with ‘symbolic’ key for the formula and additional keys for process parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agents.recursive_flatten">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">recursive_flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#recursive_flatten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.recursive_flatten" title="Link to this definition">¶</a></dt>
<dd><p>Recursively flatten any nested structure into a 1D list of floats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Any</em>) – Nested structure to flatten</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D list of floats</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.agents.visualize_agent_evolution">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.agents.</span></span><span class="sig-name descname"><span class="pre">visualize_agent_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/agents.html#visualize_agent_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.agents.visualize_agent_evolution" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the evolution of top agents and their utility functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of dictionaries containing historical data</p></li>
<li><p><strong>top_n</strong> (<em>int</em>) – Number of top agents to visualize</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (displays plots)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ergodicity.agents.evaluation">
<span id="ergodicity-agents-evaluation-module"></span><h2>ergodicity.agents.evaluation module<a class="headerlink" href="#module-ergodicity.agents.evaluation" title="Link to this heading">¶</a></h2>
<p>evaluation Submodule Overview</p>
<p>The <strong>`evaluation`</strong> submodule provides tools for analyzing, comparing, and optimizing utility functions in decision-making environments. It allows users to evaluate how agents which learnt their behaviour using different optimization algorithms interact with stochastic processes and fit utility functions to observed behaviors using various optimization techniques.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Utility Function Definition and Evaluation</strong>:</p>
<ul class="simple">
<li><p>The submodule allows users to define custom utility functions and optimize them based on stochastic process trajectories.</p></li>
<li><p>The <strong>`UtilityFunction`</strong> class is used to define utility functions with initial parameters, and it supports fitting parameters to minimize negative log-likelihood.</p></li>
</ul>
</li>
<li><p><strong>Utility Function Inference</strong>:</p>
<ul class="simple">
<li><p>The <strong>`UtilityFunctionInference`</strong> class facilitates the fitting of utility functions to agent decisions.</p></li>
<li><p>Users can use both maximum likelihood estimation (MLE) and Bayesian inference (using Metropolis-Hastings sampling) to fit utility functions.</p></li>
<li><p>This class also includes methods for generating datasets, fitting models, and visualizing results such as utility functions and parameter distributions.</p></li>
</ul>
</li>
<li><p><strong>Regression Analysis</strong>:</p>
<ul class="simple">
<li><p>A neural network-based regression model can be trained to predict agent preferences based on process parameters.</p></li>
<li><p>The <strong>`regression_fit()`</strong> method fits a neural network to the dataset, while <strong>`plot_regression_results()`</strong> provides visualizations of training results.</p></li>
</ul>
</li>
<li><p><strong>Utility Function Tester</strong>:</p>
<ul class="simple">
<li><p>The <strong>`UtilityFunctionTester`</strong> class allows users to test and compare multiple utility functions by simulating processes and calculating optimal utility values for each function.</p></li>
<li><p>Includes methods for generating process parameters, simulating process trajectories, and optimizing utility functions for given trajectories.</p></li>
</ul>
</li>
<li><p><strong>Inverse Reinforcement Learning (IRL)</strong>:</p>
<ul class="simple">
<li><p>The <strong>`MaxEntIRL`</strong> (Maximum Entropy Inverse Reinforcement Learning) class infers reward weights from agent behavior using observed trajectories.</p></li>
<li><p>The IRL approach fits a reward model that explains observed agent decisions by maximizing the likelihood of the agent’s actions.</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p>### Fitting Utility Functions to Agent’s Choices:</p>
<p>from ergodicity.evaluation import UtilityFunctionInference, UtilityFunction</p>
<p>from ergodicity.process.basic import BrownianMotion, GeometricBrownianMotion</p>
<p># Initialize UtilityFunctionInference</p>
<dl class="simple">
<dt>ufi = UtilityFunctionInference(‘path/to/your/model.h5’, param_ranges={</dt><dd><p>‘BrownianMotion’: {‘mu’: (0, 0.5), ‘sigma’: (0.1, 0.5)},
‘GeometricBrownianMotion’: {‘mu’: (0, 0.5), ‘sigma’: (0.1, 0.5)}</p>
</dd>
</dl>
<p>})</p>
<p># Add utility functions to be fitted</p>
<p>ufi.add_utility_function(UtilityFunction(‘Power’, lambda x, beta: x ** beta, [1.0]))</p>
<p>ufi.add_utility_function(UtilityFunction(‘Exponential’, lambda x, alpha: 1 - np.exp(-alpha * x), [1.0]))</p>
<p># Generate dataset of stochastic processes</p>
<p>dataset = ufi.generate_dataset(100)</p>
<p># Get agent’s choices based on the dataset</p>
<p>choices = ufi.get_agent_choices(dataset)</p>
<p># Fit utility functions based on the agent’s choices</p>
<p>ufi.fit_utility_functions(dataset, choices)</p>
<p># Plot the fitted utility functions</p>
<p>ufi.plot_utility_functions()</p>
<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.AgentEvaluation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">AgentEvaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#AgentEvaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.AgentEvaluation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>AgentEvaluation Class</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.AgentEvaluation.select_process">
<span class="sig-name descname"><span class="pre">select_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_processes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#AgentEvaluation.select_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.AgentEvaluation.select_process" title="Link to this definition">¶</a></dt>
<dd><p>Select a process based on the model’s predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoded_processes</strong> – Encoded processes to choose from</p></li>
<li><p><strong>select_max</strong> – Whether to select the process with the maximum score</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of the selected process</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">MaxEntIRL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MaxEntIRL (Maximum Entropy Inverse Reinforcement Learning) Class</p>
<p>This class implements the Maximum Entropy Inverse Reinforcement Learning algorithm, which aims to
recover the underlying reward function from observed optimal behavior in a Markov Decision Process (MDP).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.n_features" title="Link to this definition">¶</a></dt>
<dd><p>Number of features in the state space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.n_actions">
<span class="sig-name descname"><span class="pre">n_actions</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.n_actions" title="Link to this definition">¶</a></dt>
<dd><p>Number of possible actions in the MDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>Learning rate for the optimization process.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.n_iterations">
<span class="sig-name descname"><span class="pre">n_iterations</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.n_iterations" title="Link to this definition">¶</a></dt>
<dd><p>Number of iterations for the optimization process.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.reward_weights">
<span class="sig-name descname"><span class="pre">reward_weights</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.reward_weights" title="Link to this definition">¶</a></dt>
<dd><p>Weights representing the reward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<p>The MaxEntIRL class implements the core algorithm of Maximum Entropy Inverse Reinforcement Learning.
It aims to find a reward function that makes the observed behavior appear near-optimal. The algorithm
works by iteratively updating the reward weights to maximize the likelihood of the observed trajectories
under the maximum entropy distribution.</p>
<p>Key aspects of the implementation:</p>
<ol class="arabic simple">
<li><p>It uses feature expectations to characterize the observed behavior.</p></li>
<li><p>It computes state visitation frequencies to understand the importance of different states.</p></li>
<li><p>The optimization process uses the L-BFGS-B algorithm to find the optimal reward weights.</p></li>
<li><p>The resulting policy is computed using a softmax over Q-values.</p></li>
</ol>
<p>This implementation is particularly useful in scenarios where we want to understand the underlying
motivations or rewards that drive observed behavior, such as in robotics, autonomous systems,
or behavioral economics.</p>
<p>Usage:</p>
<blockquote>
<div><p>irl_model = MaxEntIRL(n_features=5, n_actions=3)</p>
<p>trajectories = […]  # List of observed state-action trajectories</p>
<p>learned_rewards = irl_model.fit(trajectories)</p>
<p># Predict reward for a new state</p>
<p>new_state = np.array([…])</p>
<p>predicted_reward = irl_model.predict_reward(new_state)</p>
</div></blockquote>
<p>Note: This implementation assumes discrete state and action spaces and may require modifications
for continuous domains or large-scale problems.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.compute_expected_svf">
<span class="sig-name descname"><span class="pre">compute_expected_svf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.compute_expected_svf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.compute_expected_svf" title="Link to this definition">¶</a></dt>
<dd><p>Compute expected state visitation frequency.
It estimates the expected frequency of visiting each state under the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectories</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – List of observed state-action trajectories</p></li>
<li><p><strong>policy</strong> (<em>Callable</em>) – Policy function mapping states to action probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected state visitation frequency</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.compute_gradient">
<span class="sig-name descname"><span class="pre">compute_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_svf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.compute_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.compute_gradient" title="Link to this definition">¶</a></dt>
<dd><p>Compute the gradient for the optimization.
It represents the difference between empirical feature expectations and expected state visitation frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat_exp</strong> (<em>np.ndarray</em>) – Empirical feature expectations</p></li>
<li><p><strong>exp_svf</strong> (<em>np.ndarray</em>) – Expected state visitation frequency</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradient vector</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.compute_policy">
<span class="sig-name descname"><span class="pre">compute_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.compute_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.compute_policy" title="Link to this definition">¶</a></dt>
<dd><p>Compute the policy based on current reward weights.
It uses a softmax over Q-values to derive the action probabilities.
The result is a policy that explains the observed behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – List of observed state-action trajectories</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Computed policy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.compute_state_visitation_freq">
<span class="sig-name descname"><span class="pre">compute_state_visitation_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.compute_state_visitation_freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.compute_state_visitation_freq" title="Link to this definition">¶</a></dt>
<dd><p>Compute state visitation frequencies.
It calculates the frequency of visiting each state under a given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectories</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – List of observed state-action trajectories</p></li>
<li><p><strong>policy</strong> (<em>Callable</em>) – Policy function mapping states to action probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>State visitation frequencies</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.feature_expectations">
<span class="sig-name descname"><span class="pre">feature_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.feature_expectations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.feature_expectations" title="Link to this definition">¶</a></dt>
<dd><p>Compute empirical feature expectations.
It is the average feature value observed in the given trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – List of observed state-action trajectories</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Empirical feature expectations</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fit the IRL model to the given trajectories.
The method allows to learn the reward function that explains the observed behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – List of observed state-action trajectories</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inferred reward</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.optimize_reward">
<span class="sig-name descname"><span class="pre">optimize_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.optimize_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.optimize_reward" title="Link to this definition">¶</a></dt>
<dd><p>Optimize the reward function.
It uses the L-BFGS-B algorithm to find the optimal reward weights.
The result is a reward function that explains the observed behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – List of observed state-action trajectories</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.MaxEntIRL.predict_reward">
<span class="sig-name descname"><span class="pre">predict_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#MaxEntIRL.predict_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.MaxEntIRL.predict_reward" title="Link to this definition">¶</a></dt>
<dd><p>Predict the reward for a given state.
It uses the learned reward weights to estimate the reward value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>np.ndarray</em>) – Input state for reward prediction</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted reward value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">UtilityFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>UtilityFunction Class</p>
<p>This class represents a utility function used in decision-making models and optimization problems.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunction.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunction.name" title="Link to this definition">¶</a></dt>
<dd><p>The name of the utility function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunction.func">
<span class="sig-name descname"><span class="pre">func</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunction.func" title="Link to this definition">¶</a></dt>
<dd><p>The actual utility function implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunction.initial_params">
<span class="sig-name descname"><span class="pre">initial_params</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunction.initial_params" title="Link to this definition">¶</a></dt>
<dd><p>Initial parameters for the utility function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunction.fitted_params">
<span class="sig-name descname"><span class="pre">fitted_params</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunction.fitted_params" title="Link to this definition">¶</a></dt>
<dd><p>Fitted parameters after optimization, if any.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float] or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunction.nll">
<span class="sig-name descname"><span class="pre">nll</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunction.nll" title="Link to this definition">¶</a></dt>
<dd><p>Negative log-likelihood of the fitted function, if calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or None</p>
</dd>
</dl>
</dd></dl>

<p>The UtilityFunction class encapsulates both the definition and the behavior of a utility function.
It supports initial parametrization and subsequent fitting, making it suitable for use in
optimization processes where the parameters of the utility function are adjusted based on data.</p>
<p>Usage:</p>
<blockquote>
<div><p>def power_utility(x, beta):</p>
<blockquote>
<div><p>return x ** beta</p>
</div></blockquote>
<p>util_func = UtilityFunction(“Power Utility”, power_utility, [1.0])</p>
<p># Before fitting</p>
<p>value = util_func(2.0)  # Uses initial parameter</p>
<p># After fitting (assuming fitting has been done elsewhere)</p>
<p>util_func.fitted_params = [0.8]</p>
<p>value = util_func(2.0)  # Uses fitted parameter</p>
</div></blockquote>
<p>This class is particularly useful in contexts where multiple utility functions need to be
defined, compared, and optimized, such as in economic models or decision theory applications.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">UtilityFunctionInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>UtilityFunctionInference Class</p>
<p>This class is designed for inferring and analyzing utility functions based on agent behavior
in stochastic processes. It combines machine learning, Bayesian inference, and economic modeling
to understand decision-making patterns.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.model" title="Link to this definition">¶</a></dt>
<dd><p>A neural network model loaded from a file, used for decision prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.agent">
<span class="sig-name descname"><span class="pre">agent</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.agent" title="Link to this definition">¶</a></dt>
<dd><p>An agent that uses the loaded model for decision-making.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.process_encoder">
<span class="sig-name descname"><span class="pre">process_encoder</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.process_encoder" title="Link to this definition">¶</a></dt>
<dd><p>Encoder for converting stochastic processes into a format suitable for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.tools.html#ergodicity.tools.helper.ProcessEncoder" title="ergodicity.tools.helper.ProcessEncoder">ProcessEncoder</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.utility_functions">
<span class="sig-name descname"><span class="pre">utility_functions</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Collection of utility functions to be analyzed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evaluation.UtilityFunction" title="ergodicity.agents.evaluation.UtilityFunction">UtilityFunction</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.param_ranges">
<span class="sig-name descname"><span class="pre">param_ranges</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.param_ranges" title="Link to this definition">¶</a></dt>
<dd><p>Ranges of parameters for different stochastic processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Tuple[float, float]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.mcmc_samples">
<span class="sig-name descname"><span class="pre">mcmc_samples</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.mcmc_samples" title="Link to this definition">¶</a></dt>
<dd><p>Stores samples from Markov Chain Monte Carlo simulations for Bayesian inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.regression_model">
<span class="sig-name descname"><span class="pre">regression_model</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.regression_model" title="Link to this definition">¶</a></dt>
<dd><p>A regression model for preference prediction, if trained.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.Model or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.regression_history">
<span class="sig-name descname"><span class="pre">regression_history</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.regression_history" title="Link to this definition">¶</a></dt>
<dd><p>Training history of the regression model, if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.callbacks.History or None</p>
</dd>
</dl>
</dd></dl>

<p>This class provides a comprehensive toolkit for analyzing decision-making behavior in the context
of stochastic processes. It supports various methods of utility function inference, including
maximum likelihood estimation, Bayesian inference, and inverse reinforcement learning. The class
also includes functionality for visualizing results and analyzing feature importance in the
decision-making process.</p>
<p>Usage:</p>
<blockquote>
<div><p>ufi = UtilityFunctionInference(‘path/to/model.h5’, param_ranges)</p>
<p>ufi.add_utility_function(UtilityFunction(‘Power’, utility_power, [1.0]))</p>
<p>dataset = ufi.generate_dataset(1000)</p>
<p>choices = ufi.get_agent_choices(dataset)</p>
<p>ufi.fit_utility_functions(dataset, choices)</p>
<p>ufi.plot_utility_functions()</p>
</div></blockquote>
<p>This class is particularly useful for researchers and practitioners in fields such as
economics, decision theory, and reinforcement learning, where understanding the underlying
utility functions driving agent behavior is crucial.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.add_utility_function">
<span class="sig-name descname"><span class="pre">add_utility_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility_function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.add_utility_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.add_utility_function" title="Link to this definition">¶</a></dt>
<dd><p>Add a utility function to the collection for analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>utility_function</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evaluation.UtilityFunction" title="ergodicity.agents.evaluation.UtilityFunction"><em>UtilityFunction</em></a>) – UtilityFunction instance to add</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.analyze_feature_importance">
<span class="sig-name descname"><span class="pre">analyze_feature_importance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.analyze_feature_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.analyze_feature_importance" title="Link to this definition">¶</a></dt>
<dd><p>Analyze the importance of different features in the regression model.
The method calculates the feature importance based on the weights of the first layer of the model.
It helps understand which features have the most influence on the agent’s decision-making process.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of feature names and their importance scores</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.analyze_feature_interactions">
<span class="sig-name descname"><span class="pre">analyze_feature_interactions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.analyze_feature_interactions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.analyze_feature_interactions" title="Link to this definition">¶</a></dt>
<dd><p>Analyze the interaction strength between features in the regression model.
It is done by calculating the dot product of the weights of the first layer.
The resulting matrix shows how features interact with each other in the decision-making process.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Interaction strength matrix</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.bayesian_fit_utility_functions">
<span class="sig-name descname"><span class="pre">bayesian_fit_utility_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.bayesian_fit_utility_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.bayesian_fit_utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Perform Bayesian inference on utility functions using Metropolis-Hastings sampling.
It generates samples from the posterior distribution of the utility function parameters.
Provides a distribution of parameter values instead of a single point estimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em>) – List of datasets, each containing lists of process trajectories</p></li>
<li><p><strong>choices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of agent choices</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of MCMC samples to generate</p></li>
<li><p><strong>burn_in</strong> (<em>int</em>) – Number of burn-in samples to discard</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.fit_utility_functions">
<span class="sig-name descname"><span class="pre">fit_utility_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.fit_utility_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.fit_utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Fit the utility functions to the observed choices using maximum likelihood estimation (MLE),
assuming the agent maximizes expected utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em>) – List of datasets, each containing lists of process trajectories</p></li>
<li><p><strong>choices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of agent choices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.generate_choices">
<span class="sig-name descname"><span class="pre">generate_choices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.generate_choices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.generate_choices" title="Link to this definition">¶</a></dt>
<dd><p>Generate agent choices among stochastic processes for testing utility functions with the corresponding dataset of processes to choose from.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_options</strong> – Number of process options per decision instance</p></li>
<li><p><strong>n_choices</strong> – Number of choices to generate (number of decision instances)</p></li>
</ul>
</dd>
<dt class="field-even">Return dataset<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of datasets, each containing process options</p>
</dd>
<dt class="field-odd">Rtype dataset<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[np.ndarray]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of choices where each choice is an index of the selected process</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.generate_dataset">
<span class="sig-name descname"><span class="pre">generate_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.generate_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.generate_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Generate a dataset of stochastic processes for analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_processes</strong> (<em>int</em>) – Number of datasets to generate (i.e., number of decision instances)</p></li>
<li><p><strong>n_options</strong> (<em>int</em>) – Number of process options per decision instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of datasets, each containing process options</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[np.ndarray]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.get_agent_choices">
<span class="sig-name descname"><span class="pre">get_agent_choices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.get_agent_choices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.get_agent_choices" title="Link to this definition">¶</a></dt>
<dd><p>Get the agent’s choice based on a dataset of process options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – A list of process options, each containing process data (np.ndarray)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index of the agent’s choice</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.get_process_type">
<span class="sig-name descname"><span class="pre">get_process_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_code</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.get_process_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.get_process_type" title="Link to this definition">¶</a></dt>
<dd><p>Get the process type name based on the type code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type_code</strong> (<em>int</em>) – Process type code</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Process type name</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.load_model" title="Link to this definition">¶</a></dt>
<dd><p>Load a Keras model from a file, handling potential compatibility issues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>str</em>) – Path to the model file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded Keras model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.metropolis_hastings">
<span class="sig-name descname"><span class="pre">metropolis_hastings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.metropolis_hastings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.metropolis_hastings" title="Link to this definition">¶</a></dt>
<dd><p>Perform Metropolis-Hastings sampling for Bayesian inference on utility functions.
Generates samples from the posterior distribution of the utility function parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utility_function</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evaluation.UtilityFunction" title="ergodicity.agents.evaluation.UtilityFunction"><em>UtilityFunction</em></a>) – Utility function to fit</p></li>
<li><p><strong>dataset</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em>) – List of datasets, each containing lists of process trajectories</p></li>
<li><p><strong>choices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of agent choices</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate</p></li>
<li><p><strong>burn_in</strong> (<em>int</em>) – Number of burn-in samples to discard</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of MCMC samples</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.negative_log_likelihood">
<span class="sig-name descname"><span class="pre">negative_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utility_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.negative_log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.negative_log_likelihood" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the negative log-likelihood of the utility function given the dataset and choices,
assuming the agent maximizes expected utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – Utility function parameters</p></li>
<li><p><strong>utility_func</strong> (<em>Callable</em>) – Utility function to evaluate</p></li>
<li><p><strong>dataset</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em>) – List of datasets, each containing lists of process trajectories</p></li>
<li><p><strong>choices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of agent choices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Negative log-likelihood value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.perform_irl">
<span class="sig-name descname"><span class="pre">perform_irl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.perform_irl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.perform_irl" title="Link to this definition">¶</a></dt>
<dd><p>Perform Inverse Reinforcement Learning (IRL) to infer the reward function from agent choices.
It uses the MaxEntIRL algorithm to learn the reward weights based on agent behavior.
It is designed to understand the underlying reward structure that drives the agent’s decisions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_processes</strong> (<em>int</em>) – Number of decision instances to generate for IRL</p></li>
<li><p><strong>n_options</strong> (<em>int</em>) – Number of process options per decision instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inferred reward weights</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.plot_bayesian_results">
<span class="sig-name descname"><span class="pre">plot_bayesian_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.plot_bayesian_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.plot_bayesian_results" title="Link to this definition">¶</a></dt>
<dd><p>Plot the fitted utility functions based on Bayesian inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_range</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>None</em>) – Range of x values to plot. If None, it will be determined based on the data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.plot_parameter_distributions">
<span class="sig-name descname"><span class="pre">plot_parameter_distributions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.plot_parameter_distributions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.plot_parameter_distributions" title="Link to this definition">¶</a></dt>
<dd><p>Plot the distributions of fitted parameters from Bayesian inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.plot_partial_dependence">
<span class="sig-name descname"><span class="pre">plot_partial_dependence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.plot_partial_dependence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.plot_partial_dependence" title="Link to this definition">¶</a></dt>
<dd><p>Plot the partial dependence of the predicted preference on a selected feature.
The partial dependence shows how the predicted preference changes with variations in a single feature.
It helps understand the relationship between the feature and the agent’s decision-making process.
It is calculated by fixing all other features at a reference point and varying the selected feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_index</strong> (<em>int</em>) – Index of the feature to analyze</p></li>
<li><p><strong>num_points</strong> (<em>int</em>) – Number of points to sample for the selected feature</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.plot_preference_heatmap">
<span class="sig-name descname"><span class="pre">plot_preference_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.plot_preference_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.plot_preference_heatmap" title="Link to this definition">¶</a></dt>
<dd><p>Plot a heatmap of agent preferences for different parameter values of a process type.
The heatmap shows how the agent’s preference changes with different parameter combinations.
It allows visualizing the utility landscape for the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process_type</strong> (<em>str</em>) – Type of the stochastic process</p></li>
<li><p><strong>param1</strong> (<em>str</em>) – First parameter to vary</p></li>
<li><p><strong>param2</strong> (<em>str</em>) – Second parameter to vary</p></li>
<li><p><strong>n_points</strong> (<em>int</em>) – Number of points to sample for each parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.plot_regression_results">
<span class="sig-name descname"><span class="pre">plot_regression_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.plot_regression_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.plot_regression_results" title="Link to this definition">¶</a></dt>
<dd><p>Plot the results of the regression model training.
It includes accuracy and loss curves for both training and validation sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.plot_utility_functions">
<span class="sig-name descname"><span class="pre">plot_utility_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0.5)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.plot_utility_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.plot_utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Plot the fitted utility functions for visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_range</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Range of x values to plot</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.predict_preference">
<span class="sig-name descname"><span class="pre">predict_preference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.predict_preference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.predict_preference" title="Link to this definition">¶</a></dt>
<dd><p>Predict the agent’s preference for a given process type and parameters.
It is done by encoding the process and passing it through the regression model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process_type</strong> (<em>str</em>) – Type of the stochastic process</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>) – Parameters of the stochastic process</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted preference value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.print_bayesian_results">
<span class="sig-name descname"><span class="pre">print_bayesian_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.print_bayesian_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.print_bayesian_results" title="Link to this definition">¶</a></dt>
<dd><p>Print the mean and standard deviation of the fitted parameters from Bayesian inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.print_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.print_results" title="Link to this definition">¶</a></dt>
<dd><p>Print the fitted utility functions and their parameters, including negative log-likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionInference.regression_fit">
<span class="sig-name descname"><span class="pre">regression_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionInference.regression_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionInference.regression_fit" title="Link to this definition">¶</a></dt>
<dd><p>Train a regression model to predict agent preferences based on process parameters.
The model is trained using a dataset of stochastic processes and agent choices,
assuming the agent maximizes expected utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_processes</strong> (<em>int</em>) – Number of decision instances to generate for training</p></li>
<li><p><strong>n_options</strong> (<em>int</em>) – Number of process options per decision instance</p></li>
<li><p><strong>test_size</strong> (<em>float</em>) – Fraction of data to use for testing</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of training epochs</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are invalid</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">UtilityFunctionTester</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utility_functions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>UtilityFunctionTester Class</p>
<p>This class is designed to test and analyze various utility functions against stochastic processes.
It provides tools for generating process parameters, simulating processes, optimizing utility
functions, and analyzing the results through statistical and visual methods.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.process_class">
<span class="sig-name descname"><span class="pre">process_class</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.process_class" title="Link to this definition">¶</a></dt>
<dd><p>The class of the stochastic process to be tested.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.param_ranges">
<span class="sig-name descname"><span class="pre">param_ranges</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.param_ranges" title="Link to this definition">¶</a></dt>
<dd><p>Ranges for each parameter of the process.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Tuple[float, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.utility_functions">
<span class="sig-name descname"><span class="pre">utility_functions</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of utility functions to be tested.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.results">
<span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.results" title="Link to this definition">¶</a></dt>
<dd><p>Stores the results of the tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<p>This class provides a comprehensive framework for evaluating and comparing different utility
functions in the context of stochastic processes. It is particularly useful for researchers
and practitioners in fields such as economics, finance, and decision theory, where
understanding the performance of utility functions under various stochastic conditions is crucial.</p>
<p>Key features:</p>
<ol class="arabic simple">
<li><p>Automatic generation of process parameters for comprehensive testing.</p></li>
<li><p>Parallel processing capability for efficient large-scale testing.</p></li>
<li><p>Advanced statistical analysis including correlation, PCA, and clustering.</p></li>
<li><p>Visualization tools for intuitive interpretation of results.</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><p>process_class = BrownianMotion</p>
<p>param_ranges = {‘mu’: (0, 0.5), ‘sigma’: (0.1, 0.5)}</p>
<dl class="simple">
<dt>utility_functions = {</dt><dd><p>‘power’: lambda x, beta: x ** beta,
‘exponential’: lambda x, alpha: 1 - np.exp(-alpha * x),
‘logarithmic’: lambda x, gamma: np.log(1 + gamma * x)</p>
</dd>
</dl>
<p>}</p>
<p>tester = UtilityFunctionTester(process_class, param_ranges, utility_functions)</p>
<p>tester.run_tests(n_processes=1000, n_steps=1000)</p>
<p>tester.analyze_results()</p>
<p>tester.plot_optimal_utility_vs_process_params()</p>
</div></blockquote>
<p>This class enables researchers to gain insights into how different utility functions perform
under various stochastic process conditions, helping in the selection and refinement of
utility models for specific applications.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.analyze_results">
<span class="sig-name descname"><span class="pre">analyze_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.analyze_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.analyze_results" title="Link to this definition">¶</a></dt>
<dd><p>Perform statistical analysis on the test results for all utility functions.
It includes correlation analysis, PCA, and clustering to understand the relationships.
The results are aimed to demonstrate the performance and characteristics of each utility function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.calculate_utility">
<span class="sig-name descname"><span class="pre">calculate_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utility_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.calculate_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.calculate_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the utility of a given stochastic process instance using a utility function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utility_func</strong> (<em>Callable</em>) – Utility function to evaluate</p></li>
<li><p><strong>trajectory</strong> (<em>np.ndarray</em>) – Trajectory of the stochastic process</p></li>
<li><p><strong>utility_params</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – Parameters of the utility function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.generate_process_parameters">
<span class="sig-name descname"><span class="pre">generate_process_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.generate_process_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.generate_process_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Generate random process parameters within specified ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_samples</strong> (<em>int</em>) – Number of parameter sets to generate</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of process parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[str, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.optimize_utility_function">
<span class="sig-name descname"><span class="pre">optimize_utility_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.optimize_utility_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.optimize_utility_function" title="Link to this definition">¶</a></dt>
<dd><p>Optimize the parameters of a utility function for a given trajectory.
It is done by maximizing the utility value using numerical optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utility_func</strong> (<em>Callable</em>) – Utility function to optimize</p></li>
<li><p><strong>trajectory</strong> (<em>np.ndarray</em>) – Trajectory of the stochastic process</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of optimal parameters and maximum utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[float], float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.plot_optimal_utility_vs_process_params">
<span class="sig-name descname"><span class="pre">plot_optimal_utility_vs_process_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.plot_optimal_utility_vs_process_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.plot_optimal_utility_vs_process_params" title="Link to this definition">¶</a></dt>
<dd><p>Plot the relationship between process parameters and optimal utility values.
It visualizes how the utility functions perform under different process conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.run_tests">
<span class="sig-name descname"><span class="pre">run_tests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.run_tests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.run_tests" title="Link to this definition">¶</a></dt>
<dd><p>Run tests for multiple processes in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_processes</strong> (<em>int</em>) – Number of processes to test</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps to simulate for each process</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – Number of parallel jobs to run (-1 for all cores)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.simulate_process">
<span class="sig-name descname"><span class="pre">simulate_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.simulate_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.simulate_process" title="Link to this definition">¶</a></dt>
<dd><p>Simulate the stochastic process with given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>) – Parameters of the process</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps to simulate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trajectory of the process</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.UtilityFunctionTester.test_utility_functions">
<span class="sig-name descname"><span class="pre">test_utility_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#UtilityFunctionTester.test_utility_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.UtilityFunctionTester.test_utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Test all utility functions against a simulated process trajectory.
It evaluates each utility function’s performance and optimizes its parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of results for each utility function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.evaluate_utility_functions">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">evaluate_utility_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility_functions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_process_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_instances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#evaluate_utility_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.evaluate_utility_functions" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate utility functions based on agent choices.
The utility functions are estimated according to the maximum likelihood of the agent’s choices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utility_functions</strong> – List of utility functions to evaluate</p></li>
<li><p><strong>agent</strong> – An instance of the AgentEvaluation class</p></li>
<li><p><strong>processes</strong> – A list of process types</p></li>
<li><p><strong>param_ranges</strong> – A dictionary of parameter ranges for each process type</p></li>
<li><p><strong>n_process_batches</strong> – Number of process batches to evaluate</p></li>
<li><p><strong>n_options</strong> – Number of process options per batch</p></li>
<li><p><strong>num_instances</strong> – Number of instances used in the expected utility calculation</p></li>
<li><p><strong>select_max</strong> – Whether to select the process with the maximum expected utility or with the minimum</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Dict[str, float]]</p>
</dd>
<dt class="field-odd">Rtype agent<span class="colon">:</span></dt>
<dd class="field-odd"><p>AgentEvaluation</p>
</dd>
<dt class="field-even">Rtype processes<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Dict[str, str]]</p>
</dd>
<dt class="field-odd">Rtype param_ranges<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Tuple[float, float]]]</p>
</dd>
<dt class="field-even">Rtype n_process_batches<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Rtype n_options<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Rtype num_instances<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Rtype select_max<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of likelihood scores for each utility function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_arctan">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_arctan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_arctan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_arctan" title="Link to this definition">¶</a></dt>
<dd><p>Arctan utility function.
The expression is: U(x) = arctan(k * x)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Input value</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Utility parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_cobb_douglas">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_cobb_douglas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_cobb_douglas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_cobb_douglas" title="Link to this definition">¶</a></dt>
<dd><p>Cobb-Douglas utility function.
The expression is: U(x) = x^alpha * (1 - x)^beta</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Input value</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Utility parameter corresponding to first term</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Utility parameter corresponding to second term</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_exp">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_exp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_linear_threshold">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_linear_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_linear_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_linear_threshold" title="Link to this definition">¶</a></dt>
<dd><p>Linear threshold utility function.
The expression is: U(x) = max(0, a * x - b)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Input value</p></li>
<li><p><strong>a</strong> (<em>float</em>) – Utility parameter corresponding to linear term</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Utility parameter   corresponding to threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_log">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_log" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_power">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_power" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_prospect_theory">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_prospect_theory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_prospect_theory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_prospect_theory" title="Link to this definition">¶</a></dt>
<dd><p>Prospect Theory utility function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Input value</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Utility parameter corresponding to loss aversion</p></li>
<li><p><strong>lambda</strong> (<em>float</em>) – Utility parameter corresponding to risk-seeking behavior</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_quadratic">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_quadratic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_quadratic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_quadratic" title="Link to this definition">¶</a></dt>
<dd><p>Quadratic utility function.
The expression is: U(x) = a * x - b * x^2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Input value</p></li>
<li><p><strong>a</strong> (<em>float</em>) – Utility parameter corresponding to linear term</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Utility parameter corresponding to quadratic term</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.evaluation.utility_sigmoid">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evaluation.</span></span><span class="sig-name descname"><span class="pre">utility_sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evaluation.html#utility_sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evaluation.utility_sigmoid" title="Link to this definition">¶</a></dt>
<dd><p>Sigmoid utility function.
The expression is: U(x) = 1 / (1 + exp(-k * (x - x0)))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Input value</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Utility parameter controlling slope</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Utility parameter controlling inflection point</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Utility value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ergodicity.agents.evolutionary_nn">
<span id="ergodicity-agents-evolutionary-nn-module"></span><h2>ergodicity.agents.evolutionary_nn module<a class="headerlink" href="#module-ergodicity.agents.evolutionary_nn" title="Link to this heading">¶</a></h2>
<p>evolutionary_nn Submodule Overview</p>
<p>The <strong>`evolutionary_nn`</strong> submodule combines neural networks with evolutionary strategies to solve problems involving stochastic processes, ergodicity, and time-optimal behaviour. This submodule allows users to create neural network-based agents that evolve over time, optimize their behavior, and select processes to maximize their wealth or other objectives. The agents can be trained using evolutionary algorithms, with or without reinforcement learning techniques.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Neural Network Creation</strong>:</p>
<ul class="simple">
<li><p>Easily create customizable feedforward neural networks with various configurations.</p></li>
<li><p>Features include batch normalization, dropout, and several activation functions (ReLU, Leaky ReLU, Tanh, etc.).</p></li>
<li><p>Supports multiple weight initialization methods (Xavier, He, etc.) and optimizers (Adam, SGD, RMSprop).</p></li>
</ul>
</li>
<li><p><strong>Agent-Based Evolution</strong>:</p>
<ul class="simple">
<li><p>The <cite>NeuralNetworkAgent</cite> class represents agents with a neural network-based decision-making process.</p></li>
<li><p>Agents accumulate wealth based on their decisions, and their performance (fitness) is measured by their accumulated wealth.</p></li>
<li><p>Agents can mutate, reproduce, and be cloned, allowing for evolutionary strategies.</p></li>
</ul>
</li>
<li><p><strong>Evolutionary Neural Network Training</strong>:</p>
<ul class="simple">
<li><p>The <cite>EvolutionaryNeuralNetworkTrainer</cite> class enables training a population of agents using evolutionary algorithms.</p></li>
<li><p>Agents are evaluated based on their wealth, and top-performing agents are selected to produce offspring for the next generation.</p></li>
<li><p>The training process supports wealth sharing and mutation of agents to explore new strategies.</p></li>
</ul>
</li>
<li><p><strong>Reinforcement Learning with Evolution</strong>:</p>
<ul class="simple">
<li><p>The <cite>ReinforcementEvolutionaryTrainer</cite> class combines evolutionary strategies with reinforcement learning.</p></li>
<li><p>Agents are trained to select processes that maximize their wealth using reinforcement learning principles.</p></li>
<li><p>Crossover and mutation are applied to create new agents based on elite performers.</p></li>
</ul>
</li>
<li><p><strong>Process Encoding</strong>:</p>
<ul class="simple">
<li><p>The <cite>ProcessEncoder</cite> class encodes stochastic processes (e.g., Brownian motion, Geometric Brownian motion) into a numeric format for input into neural networks.</p></li>
<li><p>This allows agents to process different types of stochastic processes and make decisions based on encoded data.</p></li>
</ul>
</li>
<li><p><strong>Visualization</strong>:</p>
<ul class="simple">
<li><p>Visualize the performance of agents, including wealth evolution over time, using Matplotlib and animations.</p></li>
<li><p>Generate visualizations of neural network evolution and save the parameters of the best-performing agents to files.</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p>### Creating and Training Neural Network Agents:</p>
<p>from ergodicity.process.multiplicative import GeometricBrownianMotion, BrownianMotion</p>
<p>from ergodicity.evolutionary_nn import NeuralNetwork, NeuralNetworkAgent, EvolutionaryNeuralNetworkTrainer</p>
<p># Define stochastic processes</p>
<p>process_types = [GeometricBrownianMotion, BrownianMotion]</p>
<p>processes = generate_processes(100, process_types, param_ranges)</p>
<p># Initialize the ProcessEncoder</p>
<p>encoder = ProcessEncoder()</p>
<p># Create a neural network for an agent</p>
<p>net = NeuralNetwork(input_size=11, hidden_sizes=[20, 10], output_size=1)</p>
<p># Create an agent with the neural network</p>
<p>agent = NeuralNetworkAgent(net)</p>
<p># Train a population of agents using evolutionary strategies</p>
<dl class="simple">
<dt>trainer = EvolutionaryNeuralNetworkTrainer(</dt><dd><p>population_size=10,
input_size=11,
hidden_sizes=[20, 10],
output_size=1,
processes=processes,
process_encoder=encoder,
process_times=[1.0, 5.0, 10.0],</p>
</dd>
</dl>
<p>)</p>
<p>population, history = trainer.train(n_steps=100, save_interval=10)</p>
<p># Get the best agent</p>
<p>best_agent = max(population, key=lambda agent: agent.accumulated_wealth)</p>
<p>print(f”Best agent accumulated wealth: {best_agent.accumulated_wealth}”)</p>
<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evolutionary_nn.</span></span><span class="sig-name descname"><span class="pre">DynamicBatchNorm1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#DynamicBatchNorm1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>DynamicBatchNorm1d Class</p>
<p>This class implements a dynamic version of 1D Batch Normalization, designed to handle both
batch and single-sample inputs. It extends PyTorch’s nn.Module.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.bn">
<span class="sig-name descname"><span class="pre">bn</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.bn" title="Link to this definition">¶</a></dt>
<dd><p>Standard PyTorch 1D Batch Normalization layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.BatchNorm1d</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.running_mean">
<span class="sig-name descname"><span class="pre">running_mean</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.running_mean" title="Link to this definition">¶</a></dt>
<dd><p>Running mean of the features, not updated during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.running_var">
<span class="sig-name descname"><span class="pre">running_var</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.running_var" title="Link to this definition">¶</a></dt>
<dd><p>Running variance of the features, not updated during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Parameter</p>
</dd>
</dl>
</dd></dl>

<p>The DynamicBatchNorm1d class addresses a common issue in batch normalization where
single-sample inputs (batch size of 1) can cause problems due to the lack of batch statistics.
This implementation provides a solution by using running statistics for single samples,
ensuring stable behavior regardless of batch size.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p>Seamless handling of both batch and single-sample inputs.</p></li>
<li><p>Uses standard BatchNorm1d for batches to leverage its optimizations.</p></li>
<li><p>Fallback to running statistics for single samples to avoid statistical instability.</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><p>layer = DynamicBatchNorm1d(num_features=64)</p>
<p>output = layer(input_tensor)</p>
</div></blockquote>
<p>This class is particularly useful in scenarios where the model might receive inputs of
varying batch sizes, including single samples, such as in online learning or
when processing sequential data of varying lengths.</p>
<p>Note: The running mean and variance are not updated during training in this implementation.
For applications requiring adaptive statistics, additional logic for updating these values
may be necessary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#DynamicBatchNorm1d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.DynamicBatchNorm1d.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the dynamic Batch Normalization layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (batch_size, num_features)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evolutionary_nn.</span></span><span class="sig-name descname"><span class="pre">EvolutionaryNeuralNetworkTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.tools.html#ergodicity.tools.helper.ProcessEncoder" title="ergodicity.tools.helper.ProcessEncoder"><span class="pre">ProcessEncoder</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exchange</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_wealth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removal_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_selection_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output_nn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>EvolutionaryNeuralNetworkTrainer Class</p>
<p>This class implements an evolutionary algorithm for training neural networks to make decisions
in stochastic process environments. It manages a population of neural network agents, evolves
them over time, and provides comprehensive logging and visualization capabilities.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.population_size">
<span class="sig-name descname"><span class="pre">population_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.population_size" title="Link to this definition">¶</a></dt>
<dd><p>The number of agents in the population.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.input_size">
<span class="sig-name descname"><span class="pre">input_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.input_size" title="Link to this definition">¶</a></dt>
<dd><p>The size of the input layer for the neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.hidden_sizes">
<span class="sig-name descname"><span class="pre">hidden_sizes</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.hidden_sizes" title="Link to this definition">¶</a></dt>
<dd><p>The sizes of the hidden layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.output_size">
<span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.output_size" title="Link to this definition">¶</a></dt>
<dd><p>The size of the output layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.processes">
<span class="sig-name descname"><span class="pre">processes</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.processes" title="Link to this definition">¶</a></dt>
<dd><p>The stochastic processes used for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Union[dict, object]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.process_encoder">
<span class="sig-name descname"><span class="pre">process_encoder</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.process_encoder" title="Link to this definition">¶</a></dt>
<dd><p>Encoder for the stochastic processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.tools.html#ergodicity.tools.helper.ProcessEncoder" title="ergodicity.tools.helper.ProcessEncoder">ProcessEncoder</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.process_times">
<span class="sig-name descname"><span class="pre">process_times</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.process_times" title="Link to this definition">¶</a></dt>
<dd><p>Time horizons for process simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.mutation_rate">
<span class="sig-name descname"><span class="pre">mutation_rate</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.mutation_rate" title="Link to this definition">¶</a></dt>
<dd><p>Rate of mutation for genetic operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.mutation_scale">
<span class="sig-name descname"><span class="pre">mutation_scale</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.mutation_scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale of mutations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.with_exchange">
<span class="sig-name descname"><span class="pre">with_exchange</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.with_exchange" title="Link to this definition">¶</a></dt>
<dd><p>Whether to use population-wide information exchange.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.top_k">
<span class="sig-name descname"><span class="pre">top_k</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.top_k" title="Link to this definition">¶</a></dt>
<dd><p>Number of top agents to consider in exchange.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.exchange_interval">
<span class="sig-name descname"><span class="pre">exchange_interval</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.exchange_interval" title="Link to this definition">¶</a></dt>
<dd><p>Interval for population-wide information exchange.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.initial_wealth">
<span class="sig-name descname"><span class="pre">initial_wealth</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.initial_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Initial wealth of agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.keep_top_n">
<span class="sig-name descname"><span class="pre">keep_top_n</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.keep_top_n" title="Link to this definition">¶</a></dt>
<dd><p>Number of top agents to keep after each removal interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.removal_interval">
<span class="sig-name descname"><span class="pre">removal_interval</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.removal_interval" title="Link to this definition">¶</a></dt>
<dd><p>Interval for removing underperforming agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.process_selection_share">
<span class="sig-name descname"><span class="pre">process_selection_share</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.process_selection_share" title="Link to this definition">¶</a></dt>
<dd><p>Proportion of processes to select in each step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.output_dir" title="Link to this definition">¶</a></dt>
<dd><p>Directory for saving outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p>This class combines evolutionary algorithms with neural networks to tackle decision-making
in stochastic environments. It’s particularly suited for financial modeling, economic
simulations, and other domains with complex, uncertain dynamics.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p>Flexible neural network architecture for agents.</p></li>
<li><p>Support for various stochastic processes as the environment.</p></li>
<li><p>Evolutionary mechanisms including mutation and reproduction.</p></li>
<li><p>Option for population-wide information exchange.</p></li>
<li><p>Comprehensive logging and visualization of training progress.</p></li>
<li><p>Persistence of best models and training statistics.</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><dl class="simple">
<dt>trainer = EvolutionaryNeuralNetworkTrainer(</dt><dd><p>population_size=100,
input_size=10,
hidden_sizes=[64, 32],
output_size=1,
processes=stochastic_processes,
process_encoder=encoder,
process_times=[1.0, 2.0, 5.0],
with_exchange=True</p>
</dd>
</dl>
<p>)</p>
<p>final_population, history = trainer.train(n_steps=1000, save_interval=50)</p>
</div></blockquote>
<p>This class is ideal for researchers and practitioners in fields such as quantitative finance,
economics, and artificial intelligence who are interested in evolving adaptive agents for
decision-making in complex, stochastic environments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.initialize_population">
<span class="sig-name descname"><span class="pre">initialize_population</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.initialize_population"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.initialize_population" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the population of neural network agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of NeuralNetworkAgent instances</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.load_best_weights">
<span class="sig-name descname"><span class="pre">load_best_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.load_best_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.load_best_weights" title="Link to this definition">¶</a></dt>
<dd><p>Load the best weights into an agent’s network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – Agent instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>:rtype</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.log" title="Link to this definition">¶</a></dt>
<dd><p>Log a message to the log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em>) – Message to log</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.reproduce_with_exchange">
<span class="sig-name descname"><span class="pre">reproduce_with_exchange</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.reproduce_with_exchange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.reproduce_with_exchange" title="Link to this definition">¶</a></dt>
<dd><p>Reproduce agents with population-wide information exchange.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.reproduce_without_exchange">
<span class="sig-name descname"><span class="pre">reproduce_without_exchange</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.reproduce_without_exchange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.reproduce_without_exchange" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.save_best_weights">
<span class="sig-name descname"><span class="pre">save_best_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.save_best_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.save_best_weights" title="Link to this definition">¶</a></dt>
<dd><p>Save the weights of the best performing agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>best_agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – Best performing agent</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.save_performance_metrics">
<span class="sig-name descname"><span class="pre">save_performance_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.save_performance_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.save_performance_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Save performance metrics to a CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.select_top_agents">
<span class="sig-name descname"><span class="pre">select_top_agents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.select_top_agents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.select_top_agents" title="Link to this definition">¶</a></dt>
<dd><p>Select the top k agents based on accumulated wealth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> (<em>int</em>) – Number of top agents to select</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of top agents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.train" title="Link to this definition">¶</a></dt>
<dd><p>Run the main training loop for the specified number of steps to train the evolutionary neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of training steps</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – Interval for saving metrics and weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of final population and training history</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a>], List[Dict]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.visualize_neural_network_evolution">
<span class="sig-name descname"><span class="pre">visualize_neural_network_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_video_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'neural_network_evolution.mp4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_csv_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best_agent_params.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.visualize_neural_network_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.visualize_neural_network_evolution" title="Link to this definition">¶</a></dt>
<dd><p>Create a video visualization of the neural network evolution and save best agent parameters to CSV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_video_path</strong> (<em>str</em>) – Path to save the output video</p></li>
<li><p><strong>output_csv_path</strong> (<em>str</em>) – Path to save the CSV file with best agent parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.visualize_performance">
<span class="sig-name descname"><span class="pre">visualize_performance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#EvolutionaryNeuralNetworkTrainer.visualize_performance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.EvolutionaryNeuralNetworkTrainer.visualize_performance" title="Link to this definition">¶</a></dt>
<dd><p>Create separate visualizations for average and max wealth during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evolutionary_nn.</span></span><span class="sig-name descname"><span class="pre">NeuralNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xavier_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>NeuralNetwork Class</p>
<p>This class implements a flexible and customizable neural network using PyTorch. It provides a
wide range of options for network architecture, activation functions, regularization, and
optimization.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.input_size">
<span class="sig-name descname"><span class="pre">input_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.input_size" title="Link to this definition">¶</a></dt>
<dd><p>Size of the input layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.hidden_sizes">
<span class="sig-name descname"><span class="pre">hidden_sizes</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.hidden_sizes" title="Link to this definition">¶</a></dt>
<dd><p>Sizes of the hidden layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.output_size">
<span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.output_size" title="Link to this definition">¶</a></dt>
<dd><p>Size of the output layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.dropout_rate">
<span class="sig-name descname"><span class="pre">dropout_rate</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.dropout_rate" title="Link to this definition">¶</a></dt>
<dd><p>Dropout rate for regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.batch_norm">
<span class="sig-name descname"><span class="pre">batch_norm</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.batch_norm" title="Link to this definition">¶</a></dt>
<dd><p>Whether to use batch normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.weight_init">
<span class="sig-name descname"><span class="pre">weight_init</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.weight_init" title="Link to this definition">¶</a></dt>
<dd><p>Weight initialization method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>Learning rate for the optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.optimizer_name">
<span class="sig-name descname"><span class="pre">optimizer_name</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.optimizer_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of the optimizer to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.model" title="Link to this definition">¶</a></dt>
<dd><p>The PyTorch sequential model containing all layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.optimizer" title="Link to this definition">¶</a></dt>
<dd><p>The optimizer for training the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.optim.Optimizer</p>
</dd>
</dl>
</dd></dl>

<p>This NeuralNetwork class offers a high degree of flexibility and customization:</p>
<ol class="arabic simple">
<li><p>Supports arbitrary numbers and sizes of hidden layers.</p></li>
<li><p>Offers multiple activation functions (ReLU, LeakyReLU, Tanh, Sigmoid, ELU).</p></li>
<li><p>Includes options for dropout and batch normalization for regularization.</p></li>
<li><p>Provides various weight initialization methods (Xavier, He initialization).</p></li>
<li><p>Supports different optimizers (Adam, SGD, RMSprop).</p></li>
<li><p>Includes methods for genetic algorithm-style operations (mutation, cloning).</p></li>
<li><p>Implements save and load functionality for model persistence.</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><dl class="simple">
<dt>model = NeuralNetwork(</dt><dd><p>input_size=10,
hidden_sizes=[64, 32],
output_size=1,
activation=’relu’,
dropout_rate=0.1,
batch_norm=True,
weight_init=’he_uniform’,
optimizer=’adam’</p>
</dd>
</dl>
<p>)</p>
<p>output = model(input_tensor)</p>
<p>model.save(‘model.pth’)</p>
<p>loaded_model = NeuralNetwork.load(‘model.pth’)</p>
</div></blockquote>
<p>This class is particularly useful for experiments involving neural architecture search,
evolutionary algorithms, or any scenario requiring dynamic creation and modification of
neural networks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.clone" title="Link to this definition">¶</a></dt>
<dd><p>Create a deep copy of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Cloned network</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetwork" title="ergodicity.agents.evolutionary_nn.NeuralNetwork">NeuralNetwork</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass through the neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.get_num_parameters">
<span class="sig-name descname"><span class="pre">get_num_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork.get_num_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.get_num_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Return the total number of trainable parameters in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a model from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the input file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NeuralNetwork instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetwork" title="ergodicity.agents.evolutionary_nn.NeuralNetwork">NeuralNetwork</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.mutate">
<span class="sig-name descname"><span class="pre">mutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork.mutate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.mutate" title="Link to this definition">¶</a></dt>
<dd><p>Apply random mutations to the network parameters.
The mutations are applied by adding Gaussian noise to the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mutation_rate</strong> (<em>float</em>) – Probability of mutating each parameter</p></li>
<li><p><strong>mutation_scale</strong> (<em>float</em>) – scale of the mutation (the standard deviation of the Gaussian noise)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetwork.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetwork.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetwork.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the model state and hyperparameters to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the output file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evolutionary_nn.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neural_network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetwork" title="ergodicity.agents.evolutionary_nn.NeuralNetwork"><span class="pre">NeuralNetwork</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_wealth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>NeuralNetworkAgent Class</p>
<p>This class represents an agent that uses a neural network to make decisions in a stochastic
process environment. It encapsulates the neural network along with methods for process
selection, wealth management, and evolutionary operations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.network">
<span class="sig-name descname"><span class="pre">network</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.network" title="Link to this definition">¶</a></dt>
<dd><p>The neural network used for decision making.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetwork" title="ergodicity.agents.evolutionary_nn.NeuralNetwork">NeuralNetwork</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.wealth">
<span class="sig-name descname"><span class="pre">wealth</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.wealth" title="Link to this definition">¶</a></dt>
<dd><p>The current wealth of the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.accumulated_wealth">
<span class="sig-name descname"><span class="pre">accumulated_wealth</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.accumulated_wealth" title="Link to this definition">¶</a></dt>
<dd><p>The total accumulated wealth over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.fitness">
<span class="sig-name descname"><span class="pre">fitness</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.fitness" title="Link to this definition">¶</a></dt>
<dd><p>The fitness score of the agent, based on accumulated wealth.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p>The NeuralNetworkAgent class is designed to work in environments where decisions are made
based on encoded representations of stochastic processes. It’s particularly suited for
evolutionary algorithms and reinforcement learning scenarios in financial or economic
simulations.</p>
<p>Key features:</p>
<ol class="arabic simple">
<li><p>Decision making using a neural network on encoded process representations.</p></li>
<li><p>Wealth tracking and accumulation based on process returns.</p></li>
<li><p>Fitness calculation for use in evolutionary algorithms.</p></li>
<li><p>Support for genetic operations like mutation and cloning.</p></li>
<li><p>Persistence through save and load functionality.</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><p>network = NeuralNetwork(input_size=10, hidden_sizes=[64, 32], output_size=1)</p>
<p>agent = NeuralNetworkAgent(network)</p>
<p>selected_process = agent.select_process(encoded_processes)</p>
<p>agent.update_wealth(process_return)</p>
<p>agent.calculate_fitness()</p>
<p>mutated_agent = agent.clone()</p>
<p>mutated_agent.mutate()</p>
<p>agent.save(‘agent.pth’)</p>
<p>loaded_agent = NeuralNetworkAgent.load(‘agent.pth’)</p>
</div></blockquote>
<p>This class is ideal for simulations where agents need to learn and adapt to complex,
stochastic environments, particularly in financial modeling or economic simulations
involving decision-making under uncertainty.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.calculate_fitness">
<span class="sig-name descname"><span class="pre">calculate_fitness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.calculate_fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.calculate_fitness" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the fitness of the agent based on accumulated wealth.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.clone" title="Link to this definition">¶</a></dt>
<dd><p>Create a clone of the agent with the same network structure but newly initialized weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.load" title="Link to this definition">¶</a></dt>
<dd><p>Load an agent from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the input file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NeuralNetworkAgent instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.mutate">
<span class="sig-name descname"><span class="pre">mutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.mutate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.mutate" title="Link to this definition">¶</a></dt>
<dd><p>Mutate the agent’s neural network.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.reset_wealth">
<span class="sig-name descname"><span class="pre">reset_wealth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.reset_wealth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.reset_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Reset the agent’s wealth to the initial value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the agent’s state to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the output file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.select_process">
<span class="sig-name descname"><span class="pre">select_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.select_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.select_process" title="Link to this definition">¶</a></dt>
<dd><p>Select a process based on the neural network’s output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>encoded_processes</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>]</em>) – List of encoded processes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of the selected process</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.update_wealth">
<span class="sig-name descname"><span class="pre">update_wealth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_return</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#NeuralNetworkAgent.update_wealth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent.update_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Update the agent’s wealth based on the process return.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>process_return</strong> (<em>float</em>) – The return from the selected process</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.evolutionary_nn.</span></span><span class="sig-name descname"><span class="pre">ReinforcementEvolutionaryTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.tools.html#ergodicity.tools.helper.ProcessEncoder" title="ergodicity.tools.helper.ProcessEncoder"><span class="pre">ProcessEncoder</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rl_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elite_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output_nn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>ReinforcementEvolutionaryTrainer Class
This class implements a hybrid approach combining reinforcement learning and evolutionary algorithms
for training neural network agents in stochastic process environments. It manages a population of
agents, evolves them over time, and applies reinforcement learning techniques to improve their
decision-making capabilities.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.population_size">
<span class="sig-name descname"><span class="pre">population_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.population_size" title="Link to this definition">¶</a></dt>
<dd><p>The number of agents in the population.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.input_size">
<span class="sig-name descname"><span class="pre">input_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.input_size" title="Link to this definition">¶</a></dt>
<dd><p>The size of the input layer for the neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.hidden_sizes">
<span class="sig-name descname"><span class="pre">hidden_sizes</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.hidden_sizes" title="Link to this definition">¶</a></dt>
<dd><p>The sizes of the hidden layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.output_size">
<span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.output_size" title="Link to this definition">¶</a></dt>
<dd><p>The size of the output layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.processes">
<span class="sig-name descname"><span class="pre">processes</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.processes" title="Link to this definition">¶</a></dt>
<dd><p>The stochastic processes used for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Union[dict, object]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.process_encoder">
<span class="sig-name descname"><span class="pre">process_encoder</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.process_encoder" title="Link to this definition">¶</a></dt>
<dd><p>Encoder for the stochastic processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.tools.html#ergodicity.tools.helper.ProcessEncoder" title="ergodicity.tools.helper.ProcessEncoder">ProcessEncoder</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.process_times">
<span class="sig-name descname"><span class="pre">process_times</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.process_times" title="Link to this definition">¶</a></dt>
<dd><p>Time horizons for process simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>Learning rate for the reinforcement learning updates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.mutation_rate">
<span class="sig-name descname"><span class="pre">mutation_rate</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.mutation_rate" title="Link to this definition">¶</a></dt>
<dd><p>Rate of mutation for genetic operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.mutation_scale">
<span class="sig-name descname"><span class="pre">mutation_scale</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.mutation_scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale of mutations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.rl_interval">
<span class="sig-name descname"><span class="pre">rl_interval</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.rl_interval" title="Link to this definition">¶</a></dt>
<dd><p>Interval for applying reinforcement learning updates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.elite_percentage">
<span class="sig-name descname"><span class="pre">elite_percentage</span></span><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.elite_percentage" title="Link to this definition">¶</a></dt>
<dd><p>Percentage of top-performing agents to consider as elite.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p>This class combines evolutionary algorithms with reinforcement learning to create a powerful
hybrid approach for training agents in complex, stochastic environments. It’s particularly
well-suited for financial modeling, economic simulations, and other domains with intricate,
uncertain dynamics where both long-term evolution and short-term learning are beneficial.</p>
<p>Key Features:</p>
<p>Flexible neural network architecture for agents.</p>
<p>Support for various stochastic processes as the environment.</p>
<p>Reinforcement learning updates to improve agent performance.</p>
<p>Evolutionary mechanisms including mutation, crossover, and elite selection.</p>
<p>Periodic population renewal based on fitness.</p>
<p>Adaptive learning through a combination of exploration and exploitation.</p>
<p>Usage:</p>
<p>trainer = ReinforcementEvolutionaryTrainer(
population_size=100,
input_size=10,
hidden_sizes=[64, 32],
output_size=1,
processes=stochastic_processes,
process_encoder=encoder,
process_times=[1.0, 2.0, 5.0],
learning_rate=0.001,
mutation_rate=0.1,
rl_interval=10
)</p>
<p>final_population = trainer.train(n_steps=1000)</p>
<p>This class is ideal for researchers and practitioners in fields such as quantitative finance,
economics, and artificial intelligence who are interested in developing sophisticated,
adaptive agents capable of making informed decisions in complex, stochastic environments.
The combination of evolutionary algorithms and reinforcement learning provides a robust
framework for discovering and refining effective strategies in these challenging domains.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.calculate_reward">
<span class="sig-name descname"><span class="pre">calculate_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_wealth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_wealth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.calculate_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.calculate_reward" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the reward based on the change in wealth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_wealth</strong> (<em>float</em>) – Initial wealth value</p></li>
<li><p><strong>final_wealth</strong> (<em>float</em>) – Final wealth value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reward value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.crossover">
<span class="sig-name descname"><span class="pre">crossover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.crossover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.crossover" title="Link to this definition">¶</a></dt>
<dd><p>Perform crossover between two parent agents to create a child agent.
It means that the child agent inherits some parameters from each parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent1</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – First parent agent</p></li>
<li><p><strong>parent2</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – Second parent agent</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Child agent</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.initialize_population">
<span class="sig-name descname"><span class="pre">initialize_population</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.initialize_population"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.initialize_population" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the population of neural network agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of NeuralNetworkAgent instances</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.log" title="Link to this definition">¶</a></dt>
<dd><p>Log a message to the log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em>) – Message to log</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.mutate">
<span class="sig-name descname"><span class="pre">mutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.mutate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.mutate" title="Link to this definition">¶</a></dt>
<dd><p>Apply mutation to an agent’s neural network.
The mutation is applied to the parameters of the network based on the mutation rate and scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – NeuralNetworkAgent instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.reinforce">
<span class="sig-name descname"><span class="pre">reinforce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.reinforce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.reinforce" title="Link to this definition">¶</a></dt>
<dd><p>Apply reinforcement learning update to an agent.
This is done by performing a gradient ascent step on the agent’s neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – NeuralNetworkAgent instance</p></li>
<li><p><strong>optimizer</strong> (<em>optim.Optimizer</em>) – Optimizer for the neural network</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Reward value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.save_best_weights">
<span class="sig-name descname"><span class="pre">save_best_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.save_best_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.save_best_weights" title="Link to this definition">¶</a></dt>
<dd><p>Save the weights of the best-performing agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>best_agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – Best-performing agent</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.save_performance_metrics">
<span class="sig-name descname"><span class="pre">save_performance_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.save_performance_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.save_performance_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Save performance metrics to a CSV file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.select_elite">
<span class="sig-name descname"><span class="pre">select_elite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.select_elite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.select_elite" title="Link to this definition">¶</a></dt>
<dd><p>Select the elite agents from the population.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>population</strong> (<em>List</em><em>[</em><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a><em>]</em>) – List of NeuralNetworkAgent instances</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of elite agents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.select_process">
<span class="sig-name descname"><span class="pre">select_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.select_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.select_process" title="Link to this definition">¶</a></dt>
<dd><p>Select a process and time horizon for an agent to interact with.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – NeuralNetworkAgent instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of process and time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[object, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.simulate_process">
<span class="sig-name descname"><span class="pre">simulate_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.simulate_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.simulate_process" title="Link to this definition">¶</a></dt>
<dd><p>Simulate the selected process for the given time horizon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process</strong> (<em>object</em>) – Stochastic process instance</p></li>
<li><p><strong>time</strong> (<em>float</em>) – Time horizon for simulation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Final value of the process</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.train" title="Link to this definition">¶</a></dt>
<dd><p>Run the main training loop for the specified number of steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_steps</strong> (<em>int</em>) – Number of training steps</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of final agents in the population</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.evolutionary_nn.NeuralNetworkAgent" title="ergodicity.agents.evolutionary_nn.NeuralNetworkAgent">NeuralNetworkAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.visualize_neural_network_evolution">
<span class="sig-name descname"><span class="pre">visualize_neural_network_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_video_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'neural_network_evolution.mp4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_csv_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best_agent_params.csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.visualize_neural_network_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.visualize_neural_network_evolution" title="Link to this definition">¶</a></dt>
<dd><p>Create a video visualization of the neural network evolution and save best agent parameters to CSV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_video_path</strong> (<em>str</em>) – Path to save the output video</p></li>
<li><p><strong>output_csv_path</strong> (<em>str</em>) – Path to save the CSV file with best agent parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.visualize_performance">
<span class="sig-name descname"><span class="pre">visualize_performance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/evolutionary_nn.html#ReinforcementEvolutionaryTrainer.visualize_performance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.evolutionary_nn.ReinforcementEvolutionaryTrainer.visualize_performance" title="Link to this definition">¶</a></dt>
<dd><p>Create visualizations for average and maximum fitness during training.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ergodicity.agents.portfolio">
<span id="ergodicity-agents-portfolio-module"></span><h2>ergodicity.agents.portfolio module<a class="headerlink" href="#module-ergodicity.agents.portfolio" title="Link to this heading">¶</a></h2>
<p>portfolio Submodule Overview</p>
<p>The <strong>`portfolio`</strong> submodule allows for the simulation and analysis of portfolios composed of multiple stochastic processes. This is particularly useful for studying portfolio dynamics, wealth growth, and the evolution of asset weights over time in stochastic investment environments.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Portfolio Simulation</strong>:</p>
<ul class="simple">
<li><p>Simulates a portfolio consisting of different stochastic processes (e.g., Geometric Brownian Motion).</p></li>
<li><p>Dynamically adjusts the weights of each process in the portfolio based on the simulated returns of the processes.</p></li>
</ul>
</li>
<li><p><strong>Wealth and Weight Dynamics</strong>:</p>
<ul class="simple">
<li><p>Tracks the evolution of portfolio wealth and the individual weights of each asset in the portfolio over time.</p></li>
<li><p>Allows visualization of both wealth and weight dynamics to analyze performance and diversification.</p></li>
</ul>
</li>
<li><p><strong>Process Integration</strong>:</p>
<ul class="simple">
<li><p>Works with any stochastic process object that provides a <cite>simulate()</cite> method (e.g., GeometricBrownianMotion).</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p>from ergodicity.portfolio import Portfolio</p>
<p>from ergodicity.process.multiplicative import GeometricBrownianMotion</p>
<p># Number of processes (e.g., 100 assets)</p>
<p>n = 100</p>
<p># Create stochastic processes (e.g., GBMs for assets)</p>
<p>processes = []</p>
<p>for i in range(n):</p>
<blockquote>
<div><p>gbm = GeometricBrownianMotion(drift=0.016, volatility=0.3)</p>
<p>processes.append(gbm)</p>
</div></blockquote>
<p># Initialize portfolio with equal weights for all assets</p>
<p>weights = [1/n] * n</p>
<p>portfolio = Portfolio(processes, weights)</p>
<p># Simulate portfolio over time</p>
<p>wealth_history, weight_history = portfolio.simulate(timestep=0.5, time_period=1, total_time=1000)</p>
<p># Visualize portfolio wealth and weight dynamics</p>
<p>portfolio.visualize()</p>
<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.portfolio.</span></span><span class="sig-name descname"><span class="pre">Portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/portfolio.html#Portfolio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Portfolio Class</p>
<p>This class represents a portfolio of stochastic processes, simulating their combined behavior
over time. It’s designed to model and analyze the dynamics of a diversified investment portfolio
in a stochastic environment.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.processes">
<span class="sig-name descname"><span class="pre">processes</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.processes" title="Link to this definition">¶</a></dt>
<dd><p>A list of stochastic process objects representing different assets.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.initial_weights">
<span class="sig-name descname"><span class="pre">initial_weights</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.initial_weights" title="Link to this definition">¶</a></dt>
<dd><p>The initial allocation weights for each process, normalized to sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.current_weights">
<span class="sig-name descname"><span class="pre">current_weights</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.current_weights" title="Link to this definition">¶</a></dt>
<dd><p>The current allocation weights, updated during simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.initial_wealth">
<span class="sig-name descname"><span class="pre">initial_wealth</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.initial_wealth" title="Link to this definition">¶</a></dt>
<dd><p>The initial wealth of the portfolio, set to 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.current_wealth">
<span class="sig-name descname"><span class="pre">current_wealth</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.current_wealth" title="Link to this definition">¶</a></dt>
<dd><p>The current wealth of the portfolio, updated during simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio._current_portfolio">
<span class="sig-name descname"><span class="pre">_current_portfolio</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio._current_portfolio" title="Link to this definition">¶</a></dt>
<dd><p>The current value of each asset in the portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.wealth_history">
<span class="sig-name descname"><span class="pre">wealth_history</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.wealth_history" title="Link to this definition">¶</a></dt>
<dd><p>A record of the portfolio’s wealth over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.weight_history">
<span class="sig-name descname"><span class="pre">weight_history</span></span><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.weight_history" title="Link to this definition">¶</a></dt>
<dd><p>A record of the asset weights over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.array]</p>
</dd>
</dl>
</dd></dl>

<p>This class is particularly useful for:</p>
<ol class="arabic simple">
<li><p>Simulating the behavior of a diversified portfolio over time.</p></li>
<li><p>Analyzing how different stochastic processes (assets) interact within a portfolio.</p></li>
<li><p>Visualizing the evolution of portfolio wealth and asset allocation.</p></li>
<li><p>Studying the effects of various rebalancing strategies (implicitly implemented through weight updates).</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><p>processes = [GeometricBrownianMotion(drift=0.05, volatility=0.2) for _ in range(5)]</p>
<p>weights = [0.2, 0.2, 0.2, 0.2, 0.2]</p>
<p>portfolio = Portfolio(processes, weights)</p>
<p>wealth_history, weight_history = portfolio.simulate(timestep=0.01, time_period=1, total_time=100)</p>
<p>portfolio.visualize()</p>
</div></blockquote>
<p>Note:
The simulation assumes that each process has a ‘simulate’ method that returns a time series
of values. The portfolio is rebalanced at each ‘time_period’ interval, reflecting a dynamic
asset allocation strategy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/portfolio.html#Portfolio.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.simulate" title="Link to this definition">¶</a></dt>
<dd><p>Simulate the portfolio over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestep</strong> (<em>float</em>) – Simulation timestep</p></li>
<li><p><strong>time_period</strong> (<em>float</em>) – Period for recalculating weights and wealth</p></li>
<li><p><strong>total_time</strong> (<em>float</em>) – Total simulation time</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of wealth history and weight history</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[float], List</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.portfolio.Portfolio.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/portfolio.html#Portfolio.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.portfolio.Portfolio.visualize" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the wealth and weight dynamics of the portfolio.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ergodicity.agents.probability_weighting">
<span id="ergodicity-agents-probability-weighting-module"></span><h2>ergodicity.agents.probability_weighting module<a class="headerlink" href="#module-ergodicity.agents.probability_weighting" title="Link to this heading">¶</a></h2>
<p>probability_weighting Submodule Overview</p>
<p>The <strong>`probability_weighting`</strong> submodule provides tools for computing and visualizing probability weighting functions in stochastic processes, particularly focusing on how different drifts and diffusions influence stochastic trajectories under changes of measure (e.g., Girsanov’s theorem).</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Girsanov’s Theorem</strong>:</p>
<ul class="simple">
<li><p>Apply Girsanov’s theorem to transform a probability measure in Geometric Brownian Motion (GBM) and other martingale processes.</p></li>
<li><p>Adjusts the drift of the process based on the probability weighting function.</p></li>
</ul>
</li>
<li><p><strong>Stochastic Simulation</strong>:</p>
<ul class="simple">
<li><p>Simulate weighted stochastic processes based on the drift and volatility parameters using the adjusted probability density function (PDF).</p></li>
</ul>
</li>
<li><p><strong>Visualization</strong>:</p>
<ul class="simple">
<li><p>Provides functions for simulating and plotting stochastic trajectories under different probability weighting schemes.</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p>from ergodicity.probability_weighting import gbm_weighting, visualize_weighting</p>
<p># Parameters for Geometric Brownian Motion (GBM)</p>
<p>initial_mu = 0.05  # Initial drift</p>
<p>sigma = 0.2  # Volatility</p>
<p># Get the weighted PDF using Girsanov’s theorem</p>
<p>weighted_pdf = gbm_weighting(initial_mu, sigma)</p>
<p># Visualize the weighted process</p>
<p>new_mu = 0.03  # New drift for visualization</p>
<p>X = visualize_weighting(weighted_pdf, new_mu, sigma, timestep=0.01, num_samples=1000, t=1.0)</p>
<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.probability_weighting.gbm_weighting">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.probability_weighting.</span></span><span class="sig-name descname"><span class="pre">gbm_weighting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_horizon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/probability_weighting.html#gbm_weighting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.probability_weighting.gbm_weighting" title="Link to this definition">¶</a></dt>
<dd><p>Apply Girsanov’s theorem to transform the probability measure of a Geometric Brownian Motion (GBM) process to a new measure.
The new measure is defined by adjusting the drift of the GBM process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_mu</strong> (<em>float</em>) – Initial drift of the GBM process. It corresponds to the intended time average of the process. So you insert the time average to get such probability weighting that taking expected value under the new measure gives the time average.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Volatility of the GBM process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weighted probability density function (PDF) after applying Girsanov’s theorem.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy.core.add.Add</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.probability_weighting.martingale_weighting">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.probability_weighting.</span></span><span class="sig-name descname"><span class="pre">martingale_weighting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/probability_weighting.html#martingale_weighting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.probability_weighting.martingale_weighting" title="Link to this definition">¶</a></dt>
<dd><p>Apply Girsanov’s theorem to transform the probability measure of a martingale process to a new measure.
The new measure is defined by adjusting the drift of the martingale process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_mu</strong> – Initial drift of the martingale process.</p></li>
<li><p><strong>initial_mu</strong> – float</p></li>
<li><p><strong>sigma</strong> – Volatility of the martingale process.</p></li>
<li><p><strong>sigma</strong> – float</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weighted probability density function (PDF) after applying Girsanov’s theorem.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy.core.add.Add</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.probability_weighting.visualize_weighting">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.probability_weighting.</span></span><span class="sig-name descname"><span class="pre">visualize_weighting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weighted_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/probability_weighting.html#visualize_weighting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.probability_weighting.visualize_weighting" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the weighted stochastic process based on the adjusted drift and volatility parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weighted_pdf</strong> (<em>sympy.core.add.Add</em>) – Weighted probability density function.</p></li>
<li><p><strong>new_mu</strong> (<em>float</em>) – New drift parameter.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Volatility parameter.</p></li>
<li><p><strong>timestep</strong> (<em>float</em>) – Time step for simulation.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of sample paths to simulate.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Total time for simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Simulated paths.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ergodicity.agents.sml">
<span id="ergodicity-agents-sml-module"></span><h2>ergodicity.agents.sml module<a class="headerlink" href="#module-ergodicity.agents.sml" title="Link to this heading">¶</a></h2>
<p>sml Submodule Overview</p>
<p>The <strong>`sml`</strong> (Stochastic machine Learning) submodule integrates stochastic processes, utility functions, and machine learning techniques to enable the study and optimization of decision-making processes in non-ergodic systems. It allows users to infer optimal behaviors in uncertain environments by simulating processes, fitting utility functions, and applying machine learning models.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p><strong>Utility Functions</strong>:</p>
<ul class="simple">
<li><p>Allows users to define utility functions, which model the preferences or satisfaction of an agent.</p></li>
<li><p>Utility functions can be optimized to find the parameters that best explain observed decisions.</p></li>
</ul>
</li>
<li><p><strong>Utility Function Inference</strong>:</p>
<ul class="simple">
<li><p><strong>UtilityFunctionInference</strong> class fits utility functions to agents’ decisions by minimizing negative log-likelihood or using Bayesian inference.</p></li>
<li><p>Includes Metropolis-Hastings MCMC sampling for fitting utility functions in a Bayesian framework.</p></li>
<li><p>Allows the user to analyze, visualize, and compare different utility functions using the provided dataset.</p></li>
</ul>
</li>
<li><p><strong>Agent-based Process Selection</strong>:</p>
<ul class="simple">
<li><p>Agents are created with neural network models that can be trained to select optimal stochastic processes based on encoded inputs.</p></li>
<li><p>Simulates multiple stochastic processes (e.g., Brownian motion, Geometric Brownian motion) to study agent preferences and process performance.</p></li>
</ul>
</li>
<li><p><strong>Utility Function Testing</strong>:</p>
<ul class="simple">
<li><p>The <strong>UtilityFunctionTester</strong> class provides tools to test different utility functions against stochastic processes.</p></li>
<li><p>Generates random process parameters and simulates trajectories, calculating and comparing the utilities of different functions for the same process.</p></li>
</ul>
</li>
<li><p><strong>Maximum Entropy Inverse Reinforcement Learning (MaxEnt IRL)</strong>:</p>
<ul class="simple">
<li><p>Enables inference of reward weights from agent behavior using <strong>MaxEntIRL</strong>.</p></li>
<li><p>Learns reward weights for different features by optimizing the expected state visitation frequencies to match observed behavior.</p></li>
</ul>
</li>
<li><p><strong>Machine Learning and Regression</strong>:</p>
<ul class="simple">
<li><p>The submodule includes a regression-based approach to predict agent preferences and analyze feature importance using neural networks.</p></li>
<li><p>Includes tools to visualize model training results, such as loss and accuracy plots, and feature importance analysis.</p></li>
</ul>
</li>
</ol>
<p>Example Usage:</p>
<p># Fitting Utility Functions to an Agent’s Choices:</p>
<p>from ergodicity.sml import UtilityFunctionInference, UtilityFunction</p>
<p>from ergodicity.process.basic import BrownianMotion, GeometricBrownianMotion</p>
<p># Initialize the inference object</p>
<dl class="simple">
<dt>ufi = UtilityFunctionInference(‘path/to/your/model.h5’, param_ranges={</dt><dd><p>‘BrownianMotion’: {‘mu’: (0, 0.5), ‘sigma’: (0.1, 0.5)},
‘GeometricBrownianMotion’: {‘mu’: (0, 0.5), ‘sigma’: (0.1, 0.5)}</p>
</dd>
</dl>
<p>})</p>
<p># Add utility functions</p>
<p>ufi.add_utility_function(UtilityFunction(‘Power’, lambda x, beta: x ** beta, [1.0]))</p>
<p>ufi.add_utility_function(UtilityFunction(‘Exponential’, lambda x, alpha: 1 - np.exp(-alpha * x), [1.0]))</p>
<p># Generate dataset</p>
<p>dataset = ufi.generate_dataset(100)</p>
<p># Get agent’s choices based on the dataset</p>
<p>choices = ufi.get_agent_choices(dataset)</p>
<p># Fit the utility functions</p>
<p>ufi.fit_utility_functions(dataset, choices)</p>
<p># Plot results</p>
<p>ufi.plot_utility_functions()</p>
<dl class="py class">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#NeuralNetworkAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>NeuralNetworkAgent Class</p>
<p>This class represents an agent that uses a neural network to make decisions in a stochastic
process environment. It encapsulates the neural network model along with methods for process
selection and wealth management.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent.model" title="Link to this definition">¶</a></dt>
<dd><p>The neural network model used for decision making.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent.wealth">
<span class="sig-name descname"><span class="pre">wealth</span></span><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent.wealth" title="Link to this definition">¶</a></dt>
<dd><p>The current wealth of the agent, initialized to 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent.performance_history">
<span class="sig-name descname"><span class="pre">performance_history</span></span><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent.performance_history" title="Link to this definition">¶</a></dt>
<dd><p>A list tracking the agent’s wealth over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<p>This class is designed for use in reinforcement learning scenarios where an agent learns to
select optimal processes in a stochastic environment. The neural network model is used to
predict the best process based on encoded representations, and the agent’s performance is
tracked through its wealth accumulation.</p>
<p>Key Features:</p>
<ol class="arabic simple">
<li><p>Integration with TensorFlow Keras models for decision making.</p></li>
<li><p>Wealth tracking to measure agent performance over time.</p></li>
<li><p>Process selection based on minimizing the predicted value from the neural network.</p></li>
<li><p>Ability to reset wealth for multiple episodes or experiments.</p></li>
</ol>
<p>Usage:</p>
<blockquote>
<div><p>model = tf.keras.Sequential([…])  # Define your neural network model</p>
<p>agent = NeuralNetworkAgent(model)</p>
<p># In each step of your simulation:</p>
<p>selected_process = agent.select_process(encoded_processes)</p>
<p>process_outcome = simulate_process(selected_process)</p>
<p>agent.update_wealth(process_outcome)</p>
<p># To start a new episode:</p>
<p>agent.reset_wealth()</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent.reset_wealth">
<span class="sig-name descname"><span class="pre">reset_wealth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#NeuralNetworkAgent.reset_wealth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent.reset_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Reset the agent’s wealth to the initial value (1.0) and clear the performance history.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent.select_process">
<span class="sig-name descname"><span class="pre">select_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#NeuralNetworkAgent.select_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent.select_process" title="Link to this definition">¶</a></dt>
<dd><p>Select the optimal process based on the encoded processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>encoded_processes</strong> (<em>np.ndarray</em>) – Array of encoded processes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of the selected process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ergodicity.agents.sml.NeuralNetworkAgent.update_wealth">
<span class="sig-name descname"><span class="pre">update_wealth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#NeuralNetworkAgent.update_wealth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.NeuralNetworkAgent.update_wealth" title="Link to this definition">¶</a></dt>
<dd><p>Update the agent’s wealth based on the outcome of a selected process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>process_value</strong> (<em>float</em>) – The return value of the selected process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.create_model">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#create_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.create_model" title="Link to this definition">¶</a></dt>
<dd><p>Create a neural network model with the specified hidden layers and output shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_layers</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of integers specifying the number of units in each hidden layer.</p></li>
<li><p><strong>output_shape</strong> (<em>int</em>) – Integer specifying the output shape of the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A compiled Keras model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.generate_dataset">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">generate_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_simulations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output_general'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#generate_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.generate_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Generate a dataset of simulated processes with random parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processes</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – List of dictionaries specifying the processes to simulate.</p></li>
<li><p><strong>param_ranges</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>tuple</em><em>]</em><em>]</em>) – Dictionary of parameter ranges for each process type.</p></li>
<li><p><strong>num_instances</strong> (<em>int</em>) – Number of instances to simulate for each process.</p></li>
<li><p><strong>n_simulations</strong> (<em>int</em>) – Number of simulations to run for each process. It sets how many process objects will be created within the specified parameter ranges.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory to save the results.</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – Boolean indicating whether to save the results to files.</p></li>
<li><p><strong>simulate_method</strong> (<em>bool</em>) – Boolean indicating whether to use the simulation method or the simulate_until method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of arrays containing the simulated process data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.pad_array">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">pad_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#pad_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.pad_array" title="Link to this definition">¶</a></dt>
<dd><p>Pad an array to the target shape with NaN values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>np.ndarray</em>) – Array to pad.</p></li>
<li><p><strong>target_shape</strong> (<em>Tuple</em><em>[</em><em>int</em><em>]</em>) – Target shape to pad the array to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.ranked_array">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">ranked_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#ranked_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.ranked_array" title="Link to this definition">¶</a></dt>
<dd><p>Rank the elements of an array in descending order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>np.ndarray</em>) – Input array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with elements and their corresponding ranks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.save_model">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.save_model" title="Link to this definition">¶</a></dt>
<dd><p>Save the full model (architecture + weights) to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – Keras model to save.</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Path to save the model file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.save_model_weights">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">save_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#save_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.save_model_weights" title="Link to this definition">¶</a></dt>
<dd><p>Save the weights of a Keras model to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – Keras model to save.</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Path to save the model weights.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.simulate_process">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">simulate_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#simulate_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.simulate_process" title="Link to this definition">¶</a></dt>
<dd><p>Simulate a stochastic process with the specified parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process_type</strong> (<em>str</em>) – Type of stochastic process to simulate.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>) – Dictionary of parameters for the stochastic process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of simulated process values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.train_agent_time">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">train_agent_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.sml.NeuralNetworkAgent" title="ergodicity.agents.sml.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_episodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_simulations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output_general'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#train_agent_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.train_agent_time" title="Link to this definition">¶</a></dt>
<dd><p>Train the agent to select optimal processes in a stochastic environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent</strong> (<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.sml.NeuralNetworkAgent" title="ergodicity.agents.sml.NeuralNetworkAgent"><em>NeuralNetworkAgent</em></a>) – NeuralNetworkAgent object to train.</p></li>
<li><p><strong>processes</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – List of process dictionaries to simulate.</p></li>
<li><p><strong>param_ranges</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>tuple</em><em>]</em><em>]</em>) – Dictionary of parameter ranges for each process type.</p></li>
<li><p><strong>n_episodes</strong> (<em>int</em>) – Number of episodes to train the agent.</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps per episode.</p></li>
<li><p><strong>num_instances</strong> (<em>int</em>) – Number of instances to simulate for each process.</p></li>
<li><p><strong>n_simulations</strong> (<em>int</em>) – Number of simulations to run for each process.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory to save the results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of agent, episode wealth history, episode performance history, min times, and actual min times.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.sml.NeuralNetworkAgent" title="ergodicity.agents.sml.NeuralNetworkAgent">NeuralNetworkAgent</a>, List[List[float]], List[float], List[float], List[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.train_agent_value">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">train_agent_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../ergodicity/docs/source/ergodicity.agents.html#ergodicity.agents.sml.NeuralNetworkAgent" title="ergodicity.agents.sml.NeuralNetworkAgent"><span class="pre">NeuralNetworkAgent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_episodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'output_general'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ergodicity_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping_patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping_min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#train_agent_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.train_agent_value" title="Link to this definition">¶</a></dt>
<dd><p>Train the agent to predict and select stochastic processes based on their values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent</strong> – NeuralNetworkAgent object to train.</p></li>
<li><p><strong>processes</strong> – List of process dictionaries to simulate.</p></li>
<li><p><strong>param_ranges</strong> – Dictionary of parameter ranges for each process type.</p></li>
<li><p><strong>n_episodes</strong> – Number of episodes to train the agent.</p></li>
<li><p><strong>n_steps</strong> – Number of steps per episode.</p></li>
<li><p><strong>output_dir</strong> – Output directory to save the results.</p></li>
<li><p><strong>ergodicity_transform</strong> – Whether to use ergodicity transform of process values.</p></li>
<li><p><strong>early_stopping_patience</strong> – Number of episodes with no improvement after which training will be stopped.</p></li>
<li><p><strong>early_stopping_min_delta</strong> – Minimum change in MSE to qualify as an improvement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of agent, episode performance history, and best MSE.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.visualize_results">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">visualize_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episode_wealth_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_performance_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual_min_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#visualize_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.visualize_results" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the results of the agent training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episode_wealth_history</strong> (<em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – List of episode wealth histories.</p></li>
<li><p><strong>episode_performance_history</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of episode performance histories.</p></li>
<li><p><strong>min_times</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of predicted min times.</p></li>
<li><p><strong>actual_min_times</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of actual min times.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory to save the visualizations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.worker">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">worker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#worker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.worker" title="Link to this definition">¶</a></dt>
<dd><p>Worker function for parallel processing.
It simulates a stochastic process with random parameters and returns the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Tuple</em>) – Tuple of arguments for the worker function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of results from the worker function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ergodicity.agents.sml.x_reach_2">
<span class="sig-prename descclassname"><span class="pre">ergodicity.agents.sml.</span></span><span class="sig-name descname"><span class="pre">x_reach_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ergodicity/agents/sml.html#x_reach_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ergodicity.agents.sml.x_reach_2" title="Link to this definition">¶</a></dt>
<dd><p>Check if the value of X is greater than or equal to 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>float</em>) – Value of X.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean indicating if X is greater than or equal to 2.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ergodicity.agents">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ergodicity.agents" title="Link to this heading">¶</a></h2>
<p>agents Module Overview</p>
<p>The <strong>`agents`</strong> module provides a comprehensive suite of tools for simulating, analyzing, and evaluating agents interacting with stochastic processes. The module is built with a focus on various decision-making frameworks, optimization strategies, evolutionary algorithms, and portfolio management. It integrates methods from utility theory, reinforcement learning, and stochastic modeling, offering flexible ways to simulate agent behaviors and dynamics in complex environments.</p>
<p>Submodules:</p>
<ol class="arabic simple">
<li><p><strong>`agent_pool.py`</strong>:</p>
<ul class="simple">
<li><p>Defines a pool of agents that interact with stochastic processes.</p></li>
<li><p>Agents in the pool can share wealth, update wealth based on individual dynamics, and simulate multi-agent environments.</p></li>
<li><p>Inequality measures such as Gini coefficient, Palma ratio, and mean logarithmic deviation are tracked to monitor wealth distribution across the agent population.</p></li>
</ul>
</li>
<li><p><strong>`agents.py`</strong>:</p>
<ul class="simple">
<li><p>Contains core agent models, focusing on decision-making in stochastic environments.</p></li>
<li><p>Includes base classes for agents interacting with processes, updating wealth, and calculating fitness based on wealth accumulation.</p></li>
<li><p>Supports agent cloning, mutation, and other operations essential for evolutionary algorithms.</p></li>
</ul>
</li>
<li><p><strong>`evaluation.py`</strong>:</p>
<ul class="simple">
<li><p>Focuses on the evaluation of agents’ decision-making using utility functions.</p></li>
<li><p>Supports utility function inference, Bayesian fitting, and the use of utility functions in reinforcement learning (RL) contexts.</p></li>
<li><p>Provides visualization and regression tools to understand how agents’ decisions evolve over time and under different stochastic conditions.</p></li>
</ul>
</li>
<li><p><strong>`evolutionary_nn.py`</strong>:</p>
<ul class="simple">
<li><p>Implements evolutionary neural networks for agents to learn optimal strategies.</p></li>
<li><p>Provides a framework for evolving agent behavior using neural networks, mutation, and crossover.</p></li>
<li><p>Includes reinforcement-based evolution for optimizing agent performance, with visualization tools for network evolution and performance tracking.</p></li>
</ul>
</li>
<li><p><strong>`portfolio.py`</strong>:</p>
<ul class="simple">
<li><p>Simulates and manages portfolios of assets that follow stochastic processes (e.g., Geometric Brownian Motion).</p></li>
<li><p>Enables agents to allocate resources across multiple processes, dynamically adjusting weights and tracking portfolio wealth over time.</p></li>
<li><p>Provides visualization of portfolio wealth and weight dynamics.</p></li>
</ul>
</li>
<li><p><strong>`probability_weighting.py`</strong>:</p>
<ul class="simple">
<li><p>Applies probability weighting to stochastic processes using Girsanov’s theorem.</p></li>
<li><p>Adjusts drift and volatility based on changes in the probability measure, simulating weighted processes and visualizing their behavior over time.</p></li>
<li><p>Useful in risk management, derivative pricing, and understanding the effects of probability distortions on process outcomes.</p></li>
</ul>
</li>
<li><p><strong>`sml.py`</strong>:</p>
<ul class="simple">
<li><p>Provides methods for Stochastic Maximum Likelihood (SML) estimation, utility optimization, and process simulation.</p></li>
<li><p>Agents can optimize their decisions based on estimated likelihood functions, updating their strategies to maximize utility or wealth in stochastic environments.</p></li>
<li><p>Includes utility function definitions and optimization routines for modeling agent preferences.</p></li>
</ul>
</li>
</ol>
<p>Applications:
The <strong>`agents`</strong> module is designed for use in multi-agent simulations, financial modeling, evolutionary algorithms, and stochastic decision-making research. It supports applications in:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Financial modeling</strong>: Simulating portfolios, agent wealth dynamics, and stochastic processes like Geometric Brownian Motion.</p></li>
<li><p><strong>Multi-agent systems</strong>: Tracking wealth distribution, inequality, and cooperative behaviors across agents in a shared environment.</p></li>
<li><p><strong>Reinforcement learning</strong>: Training agents to optimize their strategies using neural networks, evolutionary algorithms, and utility function-based evaluation.</p></li>
<li><p><strong>Risk management and probability weighting</strong>: Using Girsanov’s theorem to model the effect of probability distortions on stochastic process outcomes.</p></li>
</ul>
</div></blockquote>
<p>Example Usage:</p>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a>python
from ergodicity.agents import agent_pool, portfolio, probability_weighting</p>
<p># Example: Simulating a portfolio of Geometric Brownian Motion processes</p>
<p>from ergodicity.process.multiplicative import GeometricBrownianMotion</p>
<p>processes = [GeometricBrownianMotion(drift=0.01, volatility=0.2) for _ in range(10)]</p>
<p>weights = [0.1] * 10</p>
<p>my_portfolio = portfolio.Portfolio(processes, weights)</p>
<p>wealth_history, weight_history = my_portfolio.simulate(timestep=0.1, time_period=1.0, total_time=100)</p>
<p>my_portfolio.visualize()</p>
<p># Example: Using Girsanov’s theorem for probability weighting</p>
<p>weighted_pdf = probability_weighting.gbm_weighting(initial_mu=0.05, sigma=0.2)</p>
<p>probability_weighting.visualize_weighting(weighted_pdf, new_mu=0.03, sigma=0.2, timestep=0.01, num_samples=1000, t=1.0)</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Ergodicity Library</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Ihor Kendiukhov.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/docs/source/ergodicity.agents.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>