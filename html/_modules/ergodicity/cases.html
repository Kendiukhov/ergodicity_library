<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ergodicity.cases &#8212; Ergodicity Library 0.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <script src="../../_static/documentation_options.js?v=e259d695"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for ergodicity.cases</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">cases Module Overview</span>

<span class="sd">The **`cases`** module showcases a selection of illustrative and practical examples that demonstrate how the library can be used in a variety of contexts. These examples highlight the key functionalities of the library and serve as a guide for users to explore different features in action. Whether you are a beginner seeking to understand the basic processes or an advanced user exploring complex models, this module provides valuable insights through real-world applications.</span>

<span class="sd">Key Purposes of this Module:</span>

<span class="sd">1. **Demonstrate Library Capabilities**:</span>

<span class="sd">   - The cases are designed to show the power and flexibility of the library by showcasing its application in different domains, such as stochastic processes, evolutionary neural networks, and utility function fitting.</span>

<span class="sd">2. **Educational and Illustrative**:</span>

<span class="sd">   - Each case walks through a specific feature or combination of features, offering a hands-on way to learn how the library can be applied to real-world problems.</span>

<span class="sd">3. **Complete, Ready-to-Run Examples**:</span>

<span class="sd">   - All cases are self-contained, meaning you can execute them as they are to explore various processes, agents, and tools provided by the library.</span>

<span class="sd">4. **Broad Spectrum of Examples**:</span>

<span class="sd">   - The examples cover simple simulations, advanced stochastic modeling, neural networks, agent-based modeling, utility function fitting, and more. These cases provide a broad perspective on how the library can be leveraged in different scenarios.</span>

<span class="sd">Structure of the Module:</span>

<span class="sd">1. **`IntroCase`**:</span>

<span class="sd">   - A basic introduction to using the library with the `GeometricBrownianMotion` process. The case involves simulating data, visualizing moments, and comparing averages.</span>

<span class="sd">2. **`UtilityFitting_case`**:</span>

<span class="sd">   - Demonstrates utility function fitting by showcasing how multiple utility functions can be fitted using agent choices and different stochastic processes.</span>

<span class="sd">3. **`EvolutionaryNN_case`**:</span>

<span class="sd">   - Explores the use of evolutionary neural networks with agents making decisions based on encoded processes. The case covers process generation, neural network mutation, cloning, and evolutionary training of agents.</span>

<span class="sd">4. **`StochasticHeatEquation_case`**:</span>

<span class="sd">   - Simulates a stochastic partial differential equation (PDE), specifically the stochastic heat equation, showcasing advanced simulation techniques and visualizations like 3D plotting and animations.</span>

<span class="sd">5. **`BasicUtilityAgent_case`**:</span>

<span class="sd">   - Illustrates the use of basic utility agents interacting with `GeometricBrownianMotion`, comparing symbolic and numerical expected utilities, and running evolutionary algorithms to optimize agent behavior.</span>

<span class="sd">6. **`TimeAverageDynamicsGBM_case`**:</span>

<span class="sd">   - Focuses on time-average dynamics in a Geometric Brownian Motion process and demonstrates the ergodicity transformation.</span>

<span class="sd">7. **`GeometricLevyProcess_case`**:</span>

<span class="sd">   - Simulates and visualizes the Geometric Levy Process, showcasing how ensemble and time averages can be computed and compared.</span>

<span class="sd">8. **`VariousSimulations_case`**:</span>

<span class="sd">   - A collection of simulations involving various stochastic processes such as the Bessel process, Brownian bridge, Cauchy process, and more, illustrating the library&#39;s capabilities across multiple process types.</span>

<span class="sd">9. **`MultivariateGeometricBrownianMotion_case`**:</span>

<span class="sd">   - Demonstrates how to simulate and visualize multivariate Geometric Brownian Motion with a specified correlation matrix.</span>

<span class="sd">10. **`GeometricBrownianMotion_case`**:</span>

<span class="sd">   - Uses parallel execution to simulate the Geometric Brownian Motion process efficiently across multiple settings.</span>

<span class="sd">11. **`ItoLemmaApplication`**:</span>

<span class="sd">   - Applies Ito&#39;s Lemma to a given stochastic differential equation (SDE), providing insight into how symbolic manipulation can be used for process analysis.</span>

<span class="sd">Use Cases:</span>

<span class="sd">- **Educational Use**: The module provides learning materials for users who are new to stochastic processes, agent-based modeling, or neural networks.</span>

<span class="sd">- **Advanced Experimentation**: For experienced users, the cases demonstrate advanced features such as process encoding, utility fitting, evolutionary strategies, and stochastic PDEs.</span>

<span class="sd">- **Library Exploration**: Users can explore different parts of the library by running these cases and understanding how each component functions in practice.</span>

<span class="sd">## Important Notes:</span>

<span class="sd">- **Illustrative Nature**: While these cases serve as valuable educational tools, they also illustrate how the library can be applied to complex scenarios in a meaningful way.</span>

<span class="sd">- **Self-Contained**: Each case is self-contained and can be run independently to experiment with specific functionalities of the library.</span>

<span class="sd">- **Comprehensive Coverage**: The examples in this module cover a wide range of topics, from basic stochastic processes to advanced neural networks, making it a versatile resource for learning.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">ergodicity.process</span> <span class="k">as</span> <span class="nn">ep</span>
<span class="kn">from</span> <span class="nn">ergodicity.process</span> <span class="kn">import</span> <span class="n">multiplicative</span> <span class="k">as</span> <span class="n">em</span>
<span class="kn">import</span> <span class="nn">ergodicity.agents</span> <span class="k">as</span> <span class="nn">ea</span>
<span class="kn">import</span> <span class="nn">ergodicity.integrations</span> <span class="k">as</span> <span class="nn">ei</span>
<span class="kn">from</span> <span class="nn">ergodicity</span> <span class="kn">import</span> <span class="n">developer_tools</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ergodicity.process.default_values</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ergodicity.configurations</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ergodicity.tools.compute</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">ergodicity.tools.solve</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ergodicity.process.multiplicative</span> <span class="kn">import</span> <span class="n">GeometricBrownianMotion</span>
<span class="kn">from</span> <span class="nn">ergodicity.process.basic</span> <span class="kn">import</span> <span class="n">BrownianMotion</span>
<span class="kn">from</span> <span class="nn">ergodicity.agents.agents</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ergodicity.tools.partial_sde</span> <span class="kn">import</span> <span class="n">PSDESimulator</span>
<span class="kn">from</span> <span class="nn">ergodicity.agents.evolutionary_nn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ergodicity.agents.evaluation</span> <span class="kn">import</span> <span class="o">*</span>


<div class="viewcode-block" id="GBM_Properties_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.GBM_Properties_case">[docs]</a>
<span class="k">def</span> <span class="nf">GBM_Properties_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates how to access and modify properties of the GeometricBrownianMotion process.</span>

<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ergodicity.process.multiplicative</span> <span class="kn">import</span> <span class="n">GeometricBrownianMotion</span>

    <span class="n">gbm</span> <span class="o">=</span> <span class="n">GeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Process name: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is multiplicative: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">multiplicative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Has independent increments: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">independent</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is an Ito process: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">ito</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">gbm</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;My Custom GBM&quot;</span>
    <span class="n">gbm</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;custom_gbm_results&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated process name: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New output directory: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gbm</span><span class="o">.</span><span class="n">custom</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a custom process&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a standard library process&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gbm</span><span class="o">.</span><span class="n">simulate_with_differential</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This process uses differential methods for simulation&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This process uses probability distributions for simulation&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Process types: </span><span class="si">{</span><span class="n">gbm</span><span class="o">.</span><span class="n">types</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Add a new type</span>
    <span class="n">gbm</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;financial&quot;</span><span class="p">)</span>

    <span class="c1"># Check if the process is of a certain type</span>
    <span class="k">if</span> <span class="s2">&quot;geometric&quot;</span> <span class="ow">in</span> <span class="n">gbm</span><span class="o">.</span><span class="n">types</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a geometric process&quot;</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">ergodicity.process.basic</span> <span class="kn">import</span> <span class="n">BrownianMotion</span>

    <span class="n">processes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">GeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
        <span class="n">BrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">process</span> <span class="ow">in</span> <span class="n">processes</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Multiplicative: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">multiplicative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Independent increments: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">independent</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Types: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="IntroCase">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.IntroCase">[docs]</a>
<span class="k">def</span> <span class="nf">IntroCase</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is an introductory case that demonstrates the basic usage of the library with the GeometricBrownianMotion process.</span>

<span class="sd">    :return: simulated_data: The simulated data from the GeometricBrownianMotion process.</span>
<span class="sd">    :rtype: np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ergodicity.process.multiplicative</span> <span class="kn">import</span> <span class="n">GeometricBrownianMotion</span> <span class="k">as</span> <span class="n">GBM</span>
    <span class="n">gbm</span> <span class="o">=</span> <span class="n">GBM</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">simulated_data</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">num_instances</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">visualize_moments</span><span class="p">(</span><span class="n">simulated_data</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">ergodicity.tools.compute</span> <span class="kn">import</span> <span class="n">compare_averages</span>
    <span class="n">averages</span> <span class="o">=</span> <span class="n">compare_averages</span><span class="p">(</span><span class="n">simulated_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">simulated_data</span><span class="p">,</span> <span class="n">moments</span><span class="p">,</span> <span class="n">averages</span></div>


<div class="viewcode-block" id="UtilityFitting_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.UtilityFitting_case">[docs]</a>
<span class="k">def</span> <span class="nf">UtilityFitting_case</span><span class="p">(</span><span class="n">model_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates the functionality for the empirical utility function fitting using the UtilityFunctionInference class.</span>

<span class="sd">    :param model_path:</span>
<span class="sd">    :type model_path: str</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">processes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;BrownianMotion&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;GeometricBrownianMotion&#39;</span><span class="p">},</span>
        <span class="c1"># Add more process types here as needed</span>
    <span class="p">]</span>

    <span class="n">param_ranges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;BrownianMotion&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;drift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)},</span>
        <span class="s1">&#39;GeometricBrownianMotion&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;drift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;volatility&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)},</span>
        <span class="c1"># Add parameter ranges for other process types here</span>
    <span class="p">}</span>

    <span class="c1"># Initialize the UtilityFunctionInference with the path to your trained model</span>
    <span class="n">ufi</span> <span class="o">=</span> <span class="n">UtilityFunctionInference</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">param_ranges</span><span class="p">)</span>

    <span class="c1"># Add utility functions to be considered</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Power&#39;</span><span class="p">,</span> <span class="n">utility_power</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Exponential&#39;</span><span class="p">,</span> <span class="n">utility_exp</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Logarithmic&#39;</span><span class="p">,</span> <span class="n">utility_log</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Quadratic&#39;</span><span class="p">,</span> <span class="n">utility_quadratic</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Arctan&#39;</span><span class="p">,</span> <span class="n">utility_arctan</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Sigmoid&#39;</span><span class="p">,</span> <span class="n">utility_sigmoid</span><span class="p">,</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Linear Threshold&#39;</span><span class="p">,</span> <span class="n">utility_linear_threshold</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Cobb-Douglas&#39;</span><span class="p">,</span> <span class="n">utility_cobb_douglas</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">add_utility_function</span><span class="p">(</span><span class="n">UtilityFunction</span><span class="p">(</span><span class="s1">&#39;Prospect Theory&#39;</span><span class="p">,</span> <span class="n">utility_prospect_theory</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.88</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">]))</span>

    <span class="c1"># Generate dataset</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">ufi</span><span class="o">.</span><span class="n">generate_dataset</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span> <span class="n">num_instances</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Get agent choices</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="n">ufi</span><span class="o">.</span><span class="n">get_agent_choices</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="c1"># Fit utility functions</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">fit_utility_functions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">choices</span><span class="p">)</span>

    <span class="c1"># Print results</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>

    <span class="c1"># Plot utility functions</span>
    <span class="n">ufi</span><span class="o">.</span><span class="n">plot_utility_functions</span><span class="p">()</span>

    <span class="c1"># You can also access individual fitted utility functions</span>
    <span class="n">best_utility_function</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ufi</span><span class="o">.</span><span class="n">utility_functions</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">uf</span><span class="p">:</span> <span class="n">uf</span><span class="o">.</span><span class="n">nll</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The best-fitting utility function is: </span><span class="si">{</span><span class="n">best_utility_function</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters: </span><span class="si">{</span><span class="n">best_utility_function</span><span class="o">.</span><span class="n">fitted_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Use the best-fitting utility function</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Example input</span>
    <span class="n">utility</span> <span class="o">=</span> <span class="n">best_utility_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The utility of </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2"> according to the best-fitting function is: </span><span class="si">{</span><span class="n">utility</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="EvolutionaryNN_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.EvolutionaryNN_case">[docs]</a>
<span class="k">def</span> <span class="nf">EvolutionaryNN_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates the use of evolutionary neural networks for agent-based modeling with encoded processes.</span>
<span class="sd">    It covers process generation, neural network mutation, cloning, and evolutionary training of agents.</span>
<span class="sd">    The goal is to optimize agent behavior based on encoded processes and fitness evaluation.</span>

<span class="sd">    :return: final_agents: The final agents after the evolutionary training.</span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define process types</span>
    <span class="n">process_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">GeometricBrownianMotion</span><span class="p">,</span> <span class="n">BrownianMotion</span><span class="p">]</span>

    <span class="c1"># Define parameter ranges for each process type</span>
    <span class="n">param_ranges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;GeometricBrownianMotion&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;drift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
            <span class="s1">&#39;volatility&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;BrownianMotion&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;drift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
            <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># Generate processes</span>
    <span class="n">processes</span> <span class="o">=</span> <span class="n">generate_processes</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">process_types</span><span class="p">,</span> <span class="n">param_ranges</span><span class="p">)</span>

    <span class="c1"># print(processes)</span>

    <span class="c1"># Create a ProcessEncoder instance</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="n">ProcessEncoder</span><span class="p">()</span>

    <span class="c1"># Encode and pad all processes</span>
    <span class="n">encoded_processes</span> <span class="o">=</span> <span class="p">[</span><span class="n">encoder</span><span class="o">.</span><span class="n">pad_encoded_process</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">encode_process</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">processes</span><span class="p">]</span>

    <span class="c1"># print(encoded_processes)</span>

    <span class="c1"># Create a network with custom hyperparameters</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span>
        <span class="n">input_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
        <span class="n">hidden_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;leaky_relu&#39;</span><span class="p">,</span>
        <span class="n">output_activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span>
        <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">batch_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">weight_init</span><span class="o">=</span><span class="s1">&#39;he_uniform&#39;</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Create some dummy input</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

    <span class="c1"># Forward pass</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Network output: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of parameters: </span><span class="si">{</span><span class="n">net</span><span class="o">.</span><span class="n">get_num_parameters</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Mutate the network</span>
    <span class="n">net</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">mutation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mutation_scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="c1"># Clone the network</span>
    <span class="n">net_clone</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># Save the network</span>
    <span class="n">net</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_network.pth&#39;</span><span class="p">)</span>

    <span class="c1"># Load the network</span>
    <span class="n">loaded_net</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;my_network.pth&#39;</span><span class="p">)</span>

    <span class="c1"># Create an agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">NeuralNetworkAgent</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>

    <span class="c1"># Example list of encoded processes</span>
    <span class="n">encoded_processes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="p">]</span>

    <span class="c1"># Select a process</span>
    <span class="n">selected_index</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">select_process</span><span class="p">(</span><span class="n">encoded_processes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected process index: </span><span class="si">{</span><span class="n">selected_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Update wealth (assuming we&#39;ve simulated the selected process and got a return)</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">update_wealth</span><span class="p">(</span><span class="mf">1.05</span><span class="p">)</span>  <span class="c1"># 5% return</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated wealth: </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">wealth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate fitness</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">calculate_fitness</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent fitness: </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">fitness</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Mutate the agent</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">mutate</span><span class="p">()</span>

    <span class="c1"># Clone the agent</span>
    <span class="n">cloned_agent</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># Save and load the agent</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;agent_state.pth&quot;</span><span class="p">)</span>
    <span class="n">loaded_agent</span> <span class="o">=</span> <span class="n">NeuralNetworkAgent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;agent_state.pth&quot;</span><span class="p">)</span>

    <span class="n">process_encoder</span> <span class="o">=</span> <span class="n">ProcessEncoder</span><span class="p">()</span>

    <span class="n">process_times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

    <span class="n">trainer</span> <span class="o">=</span> <span class="n">EvolutionaryNeuralNetworkTrainer</span><span class="p">(</span>
        <span class="n">population_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">input_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>  <span class="c1"># Assuming 11 input features for the encoded process</span>
        <span class="n">hidden_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
        <span class="n">process_encoder</span><span class="o">=</span><span class="n">process_encoder</span><span class="p">,</span>
        <span class="n">with_exchange</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Set to False for the algorithm without exchange</span>
        <span class="n">top_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">exchange_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">keep_top_n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">removal_interval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">process_selection_share</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">process_times</span><span class="o">=</span><span class="n">process_times</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;output_nn/3&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">population</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">save_interval</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">best_agent</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">agent</span><span class="p">:</span> <span class="n">agent</span><span class="o">.</span><span class="n">accumulated_wealth</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best agent accumulated wealth: </span><span class="si">{</span><span class="n">best_agent</span><span class="o">.</span><span class="n">accumulated_wealth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="StochasticHeatEquation_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.StochasticHeatEquation_case">[docs]</a>
<span class="k">def</span> <span class="nf">StochasticHeatEquation_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates the simulation of a stochastic partial differential equation (PDE), specifically the stochastic heat equation.</span>

<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the PSDE components</span>
    <span class="k">def</span> <span class="nf">drift</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">u_x</span><span class="p">,</span> <span class="n">u_xx</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">u_xx</span>  <span class="c1"># Heat equation term</span>

    <span class="k">def</span> <span class="nf">diffusion</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Constant noise</span>

    <span class="k">def</span> <span class="nf">initial_condition</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># Initial sine wave</span>

    <span class="k">def</span> <span class="nf">boundary_condition</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># Zero at boundaries</span>

    <span class="c1"># Set up the simulation</span>
    <span class="n">simulator</span> <span class="o">=</span> <span class="n">PSDESimulator</span><span class="p">(</span>
        <span class="n">drift</span><span class="o">=</span><span class="n">drift</span><span class="p">,</span>
        <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
        <span class="n">initial_condition</span><span class="o">=</span><span class="n">initial_condition</span><span class="p">,</span>
        <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="n">t_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">nx</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">nt</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
        <span class="n">boundary_condition</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;neumann&quot;</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Run the simulation</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

    <span class="c1"># Plot the results</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>

    <span class="c1"># Create 3D plot</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">()</span>

    <span class="c1"># Create animation</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">create_animation</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation and visualization complete.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="BasicUtilityAgent_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.BasicUtilityAgent_case">[docs]</a>
<span class="k">def</span> <span class="nf">BasicUtilityAgent_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates the use of basic utility agents interacting with GeometricBrownianMotion processes.</span>

<span class="sd">    :return: final_agents: The final agents after the evolutionary training.</span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">drift</span><span class="o">=</span><span class="mf">0.4</span>
    <span class="n">volatility</span><span class="o">=</span><span class="mf">0.3</span>

    <span class="n">process</span> <span class="o">=</span> <span class="n">GeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="n">drift</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="n">volatility</span><span class="p">)</span>
    <span class="n">process_dict</span> <span class="o">=</span> <span class="n">process_to_dict</span><span class="p">(</span><span class="n">process</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">process_dict</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span>


    <span class="n">Agent_utility</span><span class="o">.</span><span class="n">compare_numerical_and_symbolic_expected_utility</span><span class="p">(</span><span class="n">process_dict</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">GeometricBrownianMotion</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">stochastic_process_class</span><span class="o">.</span><span class="n">closed_formula</span><span class="p">())</span>

    <span class="c1"># Example usage with multiple processes</span>
    <span class="k">def</span> <span class="nf">symbolic_process</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">mu</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">W</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_processes</span><span class="p">(</span><span class="n">num_processes</span><span class="p">,</span> <span class="n">drift_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">volatility_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)):</span>
        <span class="n">processes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_processes</span><span class="p">):</span>
            <span class="n">drift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">*</span><span class="n">drift_range</span><span class="p">)</span>
            <span class="n">volatility</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">*</span><span class="n">volatility_range</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Create a dictionary-based process</span>
                <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;symbolic&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">drift</span><span class="p">,</span> <span class="n">volatility</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">drift</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">volatility</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">volatility</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span>
                    <span class="s1">&#39;drift&#39;</span><span class="p">:</span> <span class="n">drift</span><span class="p">,</span>
                    <span class="s1">&#39;volatility&#39;</span><span class="p">:</span> <span class="n">volatility</span>
                <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Create a GeometricBrownianMotion instance</span>
                <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="n">drift</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="n">volatility</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">processes</span>

    <span class="n">n_agents</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">save_interval</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">removal_percentage</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">removal_interval</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">process_selection_share</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">keep_top_n</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">evolution_steps</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="n">processes</span> <span class="o">=</span> <span class="n">generate_processes</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># print(processes)</span>

    <span class="n">parameter</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">param_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">parameter</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">param_stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
    <span class="n">param_stds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">param_stds</span><span class="p">)</span>
    <span class="n">mutation_rate</span> <span class="o">=</span> <span class="mf">0.05</span>

    <span class="c1"># final_agents, history = Agent_utility.evolutionary_algorithm(</span>
    <span class="c1">#     n_agents, n_steps, save_interval, processes,</span>
    <span class="c1">#     param_means, param_stds, mutation_rate,</span>
    <span class="c1">#     stochastic_process_class=GeometricBrownianMotion,</span>
    <span class="c1">#     keep_top_n=keep_top_n,  # Specify the number of top agents to keep</span>
    <span class="c1">#     removal_interval=removal_interval,</span>
    <span class="c1">#     process_selection_share=process_selection_share,</span>
    <span class="c1">#     numeric_utilities=True</span>
    <span class="c1"># )</span>

    <span class="n">final_agents</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">Agent_utility</span><span class="o">.</span><span class="n">evolutionary_algorithm_with_exchange</span><span class="p">(</span><span class="n">n_agents</span><span class="o">=</span><span class="n">n_agents</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="n">n_steps</span><span class="p">,</span>
                                                                               <span class="n">save_interval</span><span class="o">=</span><span class="n">save_interval</span><span class="p">,</span>
                                                                               <span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
                                                                               <span class="n">param_means</span><span class="o">=</span><span class="n">param_means</span><span class="p">,</span>
                                                                               <span class="n">param_stds</span><span class="o">=</span><span class="n">param_stds</span><span class="p">,</span>
                                                                               <span class="n">noise_std</span><span class="o">=</span><span class="n">mutation_rate</span><span class="p">,</span>
                                                                               <span class="n">top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                                               <span class="n">stochastic_process_class</span><span class="o">=</span><span class="n">GeometricBrownianMotion</span><span class="p">,</span>
                                                                               <span class="n">process_selection_share</span><span class="o">=</span><span class="n">process_selection_share</span><span class="p">,</span>
                                                                               <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;evolution_results&#39;</span><span class="p">,</span>
                                                                               <span class="n">s</span><span class="o">=</span><span class="n">evolution_steps</span><span class="p">,</span>
                                                                               <span class="n">numeric_utilities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final agents:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">final_agents</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>

    <span class="c1"># Print some results</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of agents at the end: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">final_agents</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average wealth at the end: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">agent</span><span class="o">.</span><span class="n">wealth</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">final_agents</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">best_agent</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">final_agents</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">total_accumulated_wealth</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best agent&#39;s wealth: </span><span class="si">{</span><span class="n">best_agent</span><span class="o">.</span><span class="n">wealth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best agent&#39;s total accumulated wealth: </span><span class="si">{</span><span class="n">best_agent</span><span class="o">.</span><span class="n">total_accumulated_wealth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best agent&#39;s parameters: </span><span class="si">{</span><span class="n">best_agent</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">visualize_agent_evolution</span><span class="p">(</span><span class="n">history</span><span class="p">)</span>
    <span class="n">analyze_utility_function_trends</span><span class="p">(</span><span class="n">history</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeAverageDynamicsGBM_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.TimeAverageDynamicsGBM_case">[docs]</a>
<span class="k">def</span> <span class="nf">TimeAverageDynamicsGBM_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case focuses on time-average dynamics in a Geometric Brownian Motion process and demonstrates the ergodicity transformation.</span>

<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define symbols</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x t&#39;</span><span class="p">)</span>

    <span class="c1"># Example: Geometric Brownian Motion</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">x</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">x</span>

    <span class="c1"># Call ergodicity_transform function (assuming it&#39;s defined elsewhere)</span>
    <span class="n">is_consistent</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">a_u</span><span class="p">,</span> <span class="n">b_u</span> <span class="o">=</span> <span class="n">ergodicity_transform</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_consistent</span><span class="p">:</span>
        <span class="c1"># Calculate time average dynamics</span>
        <span class="n">time_avg_dynamics</span> <span class="o">=</span> <span class="n">calculate_time_average_dynamics</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">a_u</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">time_avg_dynamics</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Time average dynamics for Geometric Brownian Motion:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x(t) = </span><span class="si">{</span><span class="n">time_avg_dynamics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Optional: Simplify the result</span>
            <span class="n">simplified_dynamics</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">time_avg_dynamics</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simplified time average dynamics: x(t) = </span><span class="si">{</span><span class="n">simplified_dynamics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The process is not ergodic, cannot calculate time average dynamics.&quot;</span><span class="p">)</span></div>


<span class="c1"># Simulate Geometric Levy Process</span>
<div class="viewcode-block" id="GeometricLevyProcess_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.GeometricLevyProcess_case">[docs]</a>
<span class="k">def</span> <span class="nf">GeometricLevyProcess_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case simulates and visualizes the Geometric Levy Process, showcasing how ensemble and time averages can be computed and compared.</span>
<span class="sd">    It is a very general and frequently used process in many areas and the library puts a strong emphasis on it.</span>

<span class="sd">     :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="mf">0.004</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="mf">0.0036</span>
    <span class="n">correct_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">scale_default</span><span class="p">)</span><span class="o">*</span><span class="n">variance</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">glp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">multiplicative</span><span class="o">.</span><span class="n">GeometricLevyProcess</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">beta</span><span class="o">=-</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">mean</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">correct_scale</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">glp</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">num_instances</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">glp</span><span class="o">.</span><span class="n">visualize_moments</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">glp</span><span class="o">.</span><span class="n">growth_rate_ensemble_average</span><span class="p">(</span><span class="n">num_instances</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">ta</span> <span class="o">=</span> <span class="n">glp</span><span class="o">.</span><span class="n">growth_rate_time_average</span><span class="p">(</span><span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ta</span><span class="p">)</span>
    <span class="n">simulated_data_glp</span> <span class="o">=</span> <span class="p">(</span><span class="n">glp</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">num_instances</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">compare_averages</span><span class="p">(</span><span class="n">simulated_data_glp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ge</span> <span class="o">=</span> <span class="n">glp</span><span class="o">.</span><span class="n">growth_rate_ensemble_average</span><span class="p">(</span><span class="n">num_instances</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ge</span><span class="p">)</span>
    <span class="n">gt</span> <span class="o">=</span> <span class="n">glp</span><span class="o">.</span><span class="n">growth_rate_time_average</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># print(gt)</span>

    <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="VariousSimulations_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.VariousSimulations_case">[docs]</a>
<span class="k">def</span> <span class="nf">VariousSimulations_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates a collection of simulations involving various stochastic processes, showcasing the library&#39;s capabilities across multiple process types.</span>

<span class="sd">    :return: data: The simulated data for each process.</span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">moments_all</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Simulate Bessel Process</span>
    <span class="n">bp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">StandardBesselProcess</span><span class="p">()</span>
    <span class="n">simulated_data_bp</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">num_instances</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_bp</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_bp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Brownian Bridge</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">StandardBrownianBridge</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">simulated_data_bb</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">simulate_raw</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_bb</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_bb</span><span class="p">)</span>

    <span class="c1"># Simulate Brownian Excursion</span>
    <span class="n">be</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">StandardBrownianExcursion</span><span class="p">()</span>
    <span class="n">simulated_data_be</span> <span class="o">=</span> <span class="n">be</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">be</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_be</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_be</span><span class="p">)</span>
    <span class="n">moments</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Brownian Meander</span>
    <span class="n">bm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">StandardBrownianMeander</span><span class="p">()</span>
    <span class="n">simulated_data_bm</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_bm</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_bm</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Cauchy Process</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">CauchyProcess</span><span class="p">()</span>
    <span class="n">simulated_data_cp</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_cp</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_cp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Fractional Brownian Motion</span>
    <span class="n">fbm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">StandardFractionalBrownianMotion</span><span class="p">(</span><span class="n">hurst</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">simulated_data_fbm</span> <span class="o">=</span> <span class="n">fbm</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">fbm</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_fbm</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_fbm</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Gamma Process</span>
    <span class="n">gp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">GammaProcess</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">simulated_data_gp</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_gp</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_gp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Inverse Gaussian Process</span>
    <span class="n">igp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">InverseGaussianProcess</span><span class="p">()</span>
    <span class="n">simulated_data_igp</span> <span class="o">=</span> <span class="n">igp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">igp</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_igp</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_igp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate StandardMultifractionalBrownianMotion</span>
    <span class="n">smbm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">StandardMultifractionalBrownianMotion</span><span class="p">(</span><span class="n">hurst</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">simulated_data_smbm</span> <span class="o">=</span> <span class="n">smbm</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">smbm</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_smbm</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_smbm</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Wiener Process</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">WienerProcess</span><span class="p">()</span>
    <span class="n">simulated_data_pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_pp</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_pp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Poisson Process</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">PoissonProcess</span><span class="p">()</span>
    <span class="n">simulated_data_pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">simulate_live</span><span class="p">()</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">simulated_data_pp</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_pp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="c1"># Simulate Levy Stable Process</span>
    <span class="n">lsp</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">LevyStableProcess</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="n">scale_default</span><span class="p">)</span><span class="o">*</span><span class="mf">0.02</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">simulated_data_lsp</span> <span class="o">=</span> <span class="n">lsp</span><span class="o">.</span><span class="n">simulate_raw</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">num_instances</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">moments</span> <span class="o">=</span> <span class="n">lsp</span><span class="o">.</span><span class="n">visualize_moments</span><span class="p">(</span><span class="n">simulated_data_lsp</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulated_data_lsp</span><span class="p">)</span>
    <span class="n">moments_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">moments_all</span></div>



<span class="c1"># Simulate Multivariate Brownian Motion</span>
<div class="viewcode-block" id="MultivariateGeometricBrownianMotion_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.MultivariateGeometricBrownianMotion_case">[docs]</a>
<span class="k">def</span> <span class="nf">MultivariateGeometricBrownianMotion_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case demonstrates how to simulate and visualize multivariate Geometric Brownian Motion with a specified correlation matrix.</span>

<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ergodicity.process.definitions</span> <span class="kn">import</span> <span class="n">correlation_to_covariance</span>
    <span class="kn">from</span> <span class="nn">ergodicity.process.definitions</span> <span class="kn">import</span> <span class="n">create_correlation_matrix</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">correlation</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">create_correlation_matrix</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">correlation</span><span class="p">)</span>

    <span class="n">standard_devs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="o">**</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span>

    <span class="n">covariance_matrix</span> <span class="o">=</span> <span class="n">correlation_to_covariance</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">standard_devs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">covariance_matrix</span><span class="p">)</span>

    <span class="n">mbm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">multiplicative</span><span class="o">.</span><span class="n">MultivariateGeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">covariance_matrix</span><span class="p">)</span>
    <span class="c1"># simulated_data_mbm = mbm.simulate(t=100, timestep=0.1, plot=True)</span>
    <span class="n">mbm</span><span class="o">.</span><span class="n">simulate_ensemble</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1"># Simulate Geometric Brownian Motion using parallel execution</span>

<div class="viewcode-block" id="GeometricBrownianMotion_case">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.GeometricBrownianMotion_case">[docs]</a>
<span class="k">def</span> <span class="nf">GeometricBrownianMotion_case</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case uses parallel execution to simulate the Geometric Brownian Motion process efficiently across multiple settings.</span>
<span class="sd">    Geometric Brownian Motion is a fundamental process in stochastic calculus and financial mathematics.</span>

<span class="sd">    :return: results: The results of the parallel execution.</span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gbm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">multiplicative</span><span class="o">.</span><span class="n">GeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="mf">0.0011</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="mf">0.002</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">ergodicity.tools.multiprocessing</span> <span class="kn">import</span> <span class="n">ParallelExecutionManager</span>

    <span class="n">manager</span> <span class="o">=</span> <span class="n">ParallelExecutionManager</span><span class="p">()</span>

    <span class="n">tasks_to_run</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;simulate_raw&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="n">gbm</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;timestep&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;num_instances&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;save&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;simulate_raw&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="n">gbm</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;timestep&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;num_instances&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;save&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;simulate_raw&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="n">gbm</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;timestep&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s1">&#39;num_instances&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;save&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
    <span class="p">]</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">tasks_to_run</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span></div>


<div class="viewcode-block" id="ItoLemmaApplication">
<a class="viewcode-back" href="../../ergodicity.html#ergodicity.cases.ItoLemmaApplication">[docs]</a>
<span class="k">def</span> <span class="nf">ItoLemmaApplication</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This case applies Ito&#39;s Lemma to a given stochastic differential equation (SDE), providing insight into how symbolic manipulation can be used for process analysis.</span>

<span class="sd">    :return: result: The result of applying Ito&#39;s Lemma to the given SDE.</span>
<span class="sd">    :rtype: sympy.Expr</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define symbols</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x t&#39;</span><span class="p">)</span>
    <span class="n">mu1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;mu1&#39;</span><span class="p">)</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;sigma1&#39;</span><span class="p">)</span>

    <span class="c1"># Define example functions</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mu1</span><span class="o">*</span><span class="n">x</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma1</span><span class="o">*</span><span class="n">x</span>

    <span class="c1"># Apply Ito&#39;s Lemma</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ito_differential</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ito&#39;s Lemma applied to f(x,t) = x^2 * e^t with dx = 2x*dt + x*dW:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span></div>




</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Ergodicity Library</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Ihor Kendiukhov.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>