<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ergodicity.agents.portfolio &#8212; Ergodicity Library 0.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=e259d695"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for ergodicity.agents.portfolio</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">portfolio Submodule Overview</span>

<span class="sd">The **`portfolio`** submodule allows for the simulation and analysis of portfolios composed of multiple stochastic processes. This is particularly useful for studying portfolio dynamics, wealth growth, and the evolution of asset weights over time in stochastic investment environments.</span>

<span class="sd">Key Features:</span>

<span class="sd">1. **Portfolio Simulation**:</span>

<span class="sd">   - Simulates a portfolio consisting of different stochastic processes (e.g., Geometric Brownian Motion).</span>

<span class="sd">   - Dynamically adjusts the weights of each process in the portfolio based on the simulated returns of the processes.</span>

<span class="sd">2. **Wealth and Weight Dynamics**:</span>

<span class="sd">   - Tracks the evolution of portfolio wealth and the individual weights of each asset in the portfolio over time.</span>

<span class="sd">   - Allows visualization of both wealth and weight dynamics to analyze performance and diversification.</span>

<span class="sd">3. **Process Integration**:</span>

<span class="sd">   - Works with any stochastic process object that provides a `simulate()` method (e.g., GeometricBrownianMotion).</span>

<span class="sd">Example Usage:</span>

<span class="sd">from ergodicity.portfolio import Portfolio</span>

<span class="sd">from ergodicity.process.multiplicative import GeometricBrownianMotion</span>

<span class="sd"># Number of processes (e.g., 100 assets)</span>

<span class="sd">n = 100</span>

<span class="sd"># Create stochastic processes (e.g., GBMs for assets)</span>

<span class="sd">processes = []</span>

<span class="sd">for i in range(n):</span>

<span class="sd">    gbm = GeometricBrownianMotion(drift=0.016, volatility=0.3)</span>

<span class="sd">    processes.append(gbm)</span>

<span class="sd"># Initialize portfolio with equal weights for all assets</span>

<span class="sd">weights = [1/n] * n</span>

<span class="sd">portfolio = Portfolio(processes, weights)</span>

<span class="sd"># Simulate portfolio over time</span>

<span class="sd">wealth_history, weight_history = portfolio.simulate(timestep=0.5, time_period=1, total_time=1000)</span>

<span class="sd"># Visualize portfolio wealth and weight dynamics</span>

<span class="sd">portfolio.visualize()</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>

<div class="viewcode-block" id="Portfolio">
<a class="viewcode-back" href="../../../ergodicity.agents.html#ergodicity.agents.portfolio.Portfolio">[docs]</a>
<span class="k">class</span> <span class="nc">Portfolio</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Portfolio Class</span>

<span class="sd">    This class represents a portfolio of stochastic processes, simulating their combined behavior</span>
<span class="sd">    over time. It&#39;s designed to model and analyze the dynamics of a diversified investment portfolio</span>
<span class="sd">    in a stochastic environment.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        processes (List[Any]): A list of stochastic process objects representing different assets.</span>
<span class="sd">        initial_weights (np.array): The initial allocation weights for each process, normalized to sum to 1.</span>
<span class="sd">        current_weights (np.array): The current allocation weights, updated during simulation.</span>
<span class="sd">        initial_wealth (float): The initial wealth of the portfolio, set to 1.0.</span>
<span class="sd">        current_wealth (float): The current wealth of the portfolio, updated during simulation.</span>
<span class="sd">        _current_portfolio (np.array): The current value of each asset in the portfolio.</span>
<span class="sd">        wealth_history (List[float]): A record of the portfolio&#39;s wealth over time.</span>
<span class="sd">        weight_history (List[np.array]): A record of the asset weights over time.</span>

<span class="sd">    This class is particularly useful for:</span>

<span class="sd">    1. Simulating the behavior of a diversified portfolio over time.</span>

<span class="sd">    2. Analyzing how different stochastic processes (assets) interact within a portfolio.</span>

<span class="sd">    3. Visualizing the evolution of portfolio wealth and asset allocation.</span>

<span class="sd">    4. Studying the effects of various rebalancing strategies (implicitly implemented through weight updates).</span>

<span class="sd">    Usage:</span>

<span class="sd">        processes = [GeometricBrownianMotion(drift=0.05, volatility=0.2) for _ in range(5)]</span>

<span class="sd">        weights = [0.2, 0.2, 0.2, 0.2, 0.2]</span>

<span class="sd">        portfolio = Portfolio(processes, weights)</span>

<span class="sd">        wealth_history, weight_history = portfolio.simulate(timestep=0.01, time_period=1, total_time=100)</span>

<span class="sd">        portfolio.visualize()</span>

<span class="sd">    Note:</span>
<span class="sd">    The simulation assumes that each process has a &#39;simulate&#39; method that returns a time series</span>
<span class="sd">    of values. The portfolio is rebalanced at each &#39;time_period&#39; interval, reflecting a dynamic</span>
<span class="sd">    asset allocation strategy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">weights</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Portfolio.</span>

<span class="sd">        :param processes: List of stochastic process objects</span>
<span class="sd">        :type processes: List[Any]</span>
<span class="sd">        :param weights: List of initial weights for each process</span>
<span class="sd">        :type weights: List[float]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">processes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of processes must match the number of weights.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="n">processes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>  <span class="c1"># Normalize weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_weights</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_wealth</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_wealth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_wealth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_portfolio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_wealth</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wealth_history</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_wealth</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_history</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_weights</span><span class="p">]</span>

<div class="viewcode-block" id="Portfolio.simulate">
<a class="viewcode-back" href="../../../ergodicity.agents.html#ergodicity.agents.portfolio.Portfolio.simulate">[docs]</a>
    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestep</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">time_period</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">total_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate the portfolio over time.</span>

<span class="sd">        :param timestep: Simulation timestep</span>
<span class="sd">        :type timestep: float</span>
<span class="sd">        :param time_period: Period for recalculating weights and wealth</span>
<span class="sd">        :type time_period: float</span>
<span class="sd">        :param total_time: Total simulation time</span>
<span class="sd">        :type total_time: float</span>
<span class="sd">        :return: Tuple of wealth history and weight history</span>
<span class="sd">        :rtype: Tuple[List[float], List</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_time</span> <span class="o">/</span> <span class="n">timestep</span><span class="p">)</span>
        <span class="n">num_steps_per_period</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_period</span> <span class="o">/</span> <span class="n">timestep</span><span class="p">)</span>
        <span class="n">num_periods</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_time</span> <span class="o">/</span> <span class="n">time_period</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_periods</span><span class="p">):</span>

            <span class="n">changes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="n">process</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">time_period</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span> <span class="n">num_instances</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">process</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">processes</span>
            <span class="p">])</span>

            <span class="c1"># Update wealth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_wealth</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_weights</span> <span class="o">*</span> <span class="n">changes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wealth_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_wealth</span><span class="p">)</span>

            <span class="c1"># Update weights</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_portfolio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_portfolio</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">changes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_portfolio</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_portfolio</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">weight_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_weights</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wealth_history</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_history</span></div>


<div class="viewcode-block" id="Portfolio.visualize">
<a class="viewcode-back" href="../../../ergodicity.agents.html#ergodicity.agents.portfolio.Portfolio.visualize">[docs]</a>
    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualize the wealth and weight dynamics of the portfolio.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Plot wealth dynamics</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wealth_history</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Portfolio Wealth Dynamics&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Wealth&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># Plot weight dynamics</span>
        <span class="n">weight_history_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_history</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="p">)):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weight_history_array</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Process </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Portfolio Weight Dynamics&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Period&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>



<span class="c1"># Example usage:</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">ergodicity.process.multiplicative</span> <span class="kn">import</span> <span class="n">GeometricBrownianMotion</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="c1"># Create some example processes</span>
    <span class="n">processes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">gbm</span> <span class="o">=</span> <span class="n">GeometricBrownianMotion</span><span class="p">(</span><span class="n">drift</span><span class="o">=</span><span class="mf">0.016</span><span class="p">,</span> <span class="n">volatility</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gbm</span><span class="p">)</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="c1"># Create a portfolio</span>
    <span class="n">portfolio</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">processes</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Simulate the portfolio</span>
    <span class="n">wealth_history</span><span class="p">,</span> <span class="n">weight_history</span> <span class="o">=</span> <span class="n">portfolio</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">time_period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">total_time</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># Visualize the results</span>
    <span class="n">portfolio</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Ergodicity Library</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Ihor Kendiukhov.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>